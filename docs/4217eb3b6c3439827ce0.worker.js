(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.d(t,{executeQuery:()=>Qr});var n={};e.r(n),e.d(n,{compile:()=>Q,stringify:()=>V,walk:()=>Z});var r={};e.r(r),e.d(r,{compile:()=>ee,stringify:()=>ne,suggest:()=>X,walk:()=>te});var s={};e.r(s),e.d(s,{compile:()=>se,stringify:()=>ae,suggest:()=>re,walk:()=>ie});var i={};e.r(i),e.d(i,{compile:()=>ce,stringify:()=>he,suggest:()=>le,walk:()=>pe});var a={};e.r(a),e.d(a,{compile:()=>ge,stringify:()=>de,suggest:()=>fe,walk:()=>ye});var o={};e.r(o),e.d(o,{compile:()=>me,stringify:()=>be,walk:()=>Ce});var u={};e.r(u),e.d(u,{compile:()=>Be,stringify:()=>ke,walk:()=>ve});var l={};e.r(l),e.d(l,{compile:()=>Ee,stringify:()=>we,walk:()=>$e});var c={};e.r(c),e.d(c,{compile:()=>Me,stringify:()=>_e,walk:()=>De});var p={};e.r(p),e.d(p,{compile:()=>xe,stringify:()=>Ne,suggest:()=>Oe,walk:()=>qe});var h={};e.r(h),e.d(h,{compile:()=>Se,stringify:()=>Ie,walk:()=>Fe});var f={};e.r(f),e.d(f,{compile:()=>je,stringify:()=>Te,walk:()=>ze});var g={};e.r(g),e.d(g,{compile:()=>Ge,stringify:()=>Je,suggest:()=>Le,walk:()=>Ue});var y={};e.r(y),e.d(y,{compile:()=>We,stringify:()=>Ke,walk:()=>Ye});var d={};e.r(d),e.d(d,{compile:()=>Qe,stringify:()=>Ve,walk:()=>Ze});var A={};e.r(A),e.d(A,{compile:()=>et,stringify:()=>nt,suggest:()=>Xe,walk:()=>tt});var m={};e.r(m),e.d(m,{compile:()=>rt,stringify:()=>it,walk:()=>st});var C={};e.r(C),e.d(C,{compile:()=>at,stringify:()=>ut,walk:()=>ot});var b={};e.r(b),e.d(b,{compile:()=>lt,stringify:()=>pt,walk:()=>ct});var B={};e.r(B),e.d(B,{compile:()=>ht,stringify:()=>gt,walk:()=>ft});var v={};e.r(v),e.d(v,{compile:()=>dt,stringify:()=>mt,suggest:()=>yt,walk:()=>At});var k={};e.r(k),e.d(k,{compile:()=>Ct,stringify:()=>Bt,walk:()=>bt});var E={};e.r(E),e.d(E,{compile:()=>kt,stringify:()=>$t,suggest:()=>vt,walk:()=>Et});var $={};e.r($),e.d($,{compile:()=>Dt,stringify:()=>Ot,suggest:()=>Mt,walk:()=>_t});var w={};e.r(w),e.d(w,{compile:()=>xt,stringify:()=>Nt,walk:()=>qt});var M={};e.r(M),e.d(M,{compile:()=>Ft,stringify:()=>jt,suggest:()=>St,walk:()=>It});var D={};e.r(D),e.d(D,{compile:()=>zt,stringify:()=>Pt,walk:()=>Tt});var _={};e.r(_),e.d(_,{compile:()=>Ht,stringify:()=>Gt,suggest:()=>Rt,walk:()=>Lt});var O={};e.r(O),e.d(O,{compile:()=>Ut,stringify:()=>Wt,walk:()=>Jt});var x={};e.r(x),e.d(x,{compile:()=>Yt,stringify:()=>Qt,walk:()=>Kt});var q={};e.r(q),e.d(q,{compile:()=>Vt,stringify:()=>en,suggest:()=>Zt,walk:()=>Xt});var N={};e.r(N),e.d(N,{compile:()=>tn,stringify:()=>rn,walk:()=>nn});var S={};e.r(S),e.d(S,{compile:()=>an,stringify:()=>un,suggest:()=>sn,walk:()=>on});var F={};e.r(F),e.d(F,{compile:()=>cn,stringify:()=>hn,suggest:()=>ln,walk:()=>pn});const I=Object.hasOwn||((e,t)=>Object.hasOwnProperty.call(e,t)),j=Object.prototype.toString;function z(e,t){return void 0!==t&&(L(t)?t.forEach((t=>e.add(t))):e.add(t)),e}function T(e,t,n){e.has(t)?e.get(t).add(n):e.set(t,new Set([n]))}function P(e){return null!==e&&"object"===typeof e&&e.constructor===Object}function R(e){return"[object RegExp]"===j.call(e)}function H(e){return e&&I(e,"length")&&isFinite(e.length)}function L(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function G(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=parseInt(e,10);return isNaN(n)?t:n}function U(e){if(L(e))return e.length>0;if(P(e)){for(const t in e)if(I(e,t))return!0;return!1}return Boolean(e)}const J=function(){const e={yy:{},options:{ranges:!0},rules:[/^(?:\/\/.*?(?:\n|\r\n?|\u2028|\u2029|$)|\/\*(?:.|\s)*?(?:\*\/|$))/,/^\s+/,/^\//,/^<(?!=)/,/^/,/^(?:(?:[a-zA-Z_]|\\u[0-9a-fA-F]{4})(?:[a-zA-Z_$0-9]|\\u[0-9a-fA-F]{4})*\(?)/,/^/,(e,t)=>{if(e[0]!==("template"===t?"}":"`"))return null;for(let n=1;n<e.length;n++){if("`"===e[n])return n+1;if("$"===e[n]&&"{"===e[n+1])return n+2;"\\"===e[n]&&n++}return null},(e,t)=>{if(e[0]!==("template"===t?"}":"`"))return null;for(let n=1;n<e.length;n++){if("`"===e[n])return n+1;if("$"===e[n]&&"{"===e[n+1])return n+2;"\\"===e[n]&&n++}return null},/^/,/^\(/,/^\)/,/^\[/,/^\]/,/^\{/,/^\}/,/^(?:(true|false|null|undefined|Infinity|NaN)\b)/,/^and\b/,/^or\b/,/^is\b/,/^has\s+no\b/,/^has\b/,/^in\b/,/^not\s+in\b/,/^not\b/,/^no\b/,/^(?:(asc|desc)(NA?|AN?)?\b)/,/^(?:(?:[a-zA-Z_]|\\u[0-9a-fA-F]{4})(?:[a-zA-Z_$0-9]|\\u[0-9a-fA-F]{4})*\()/,/^(?:\$(?:[a-zA-Z_]|\\u[0-9a-fA-F]{4})(?:[a-zA-Z_$0-9]|\\u[0-9a-fA-F]{4})*\()/,/^(?:(?:[a-zA-Z_]|\\u[0-9a-fA-F]{4})(?:[a-zA-Z_$0-9]|\\u[0-9a-fA-F]{4})*)/,/^(?:\$(?:[a-zA-Z_]|\\u[0-9a-fA-F]{4})(?:[a-zA-Z_$0-9]|\\u[0-9a-fA-F]{4})*)/,/^(?:[_\d]*\.)?[_\d]+(?:[eE][-+]?[_\d]+)?\b/,/^(?:\d*\.)?\d+(?:[eE][-+]?\d+)?\b/,/^0[xX][_0-9a-fA-F]+/,/^0[xX][0-9a-fA-F]+/,/^(?:"(?:\\[\\"]|[^"])*")/,/^(?:'(?:\\[\\']|[^'])*')/,/^(?:\/(?:\\.|[^/])+\/[gimsu]*)/,/^@/,/^#/,/^\$\$/,/^\$/,/^=>/,/^=/,/^!=/,/^~=/,/^>=/,/^<=/,/^</,/^>/,/^\.\.\(/,/^\.\(/,/^\.\[/,/^\.\.\./,/^\.\./,/^\./,/^\?\?/,/^\?/,/^,/,/^:/,/^;/,/^\-/,/^\+/,/^\*/,/^\//,/^\%/,/^(?:\|)/,/^./,/^$/],conditions:{preventPrimitive:{rules:[0,1,2,3,4,7,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68],inclusive:!0},preventKeyword:{rules:[5,6],inclusive:!1},template:{rules:[8,9],inclusive:!1},INITIAL:{rules:[0,1,7,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68],inclusive:!0}},performAction(e,t,n,r){switch(n){case 0:e.commentRanges.push(t.yylloc.range);break;case 1:break;case 2:return this.popState(),40;case 3:return this.popState(),44;case 4:case 6:this.done=!1,this.popState();break;case 5:return this.popState(),t.yytext.endsWith("(")?void this.unput(t.yytext):(e.pps(),t.yytext=this.ident(t.yytext),14);case 7:{const n=t.yytext.endsWith("`")?"TEMPLATE":"TPL_START";return t.yytext=this.toStringLiteral(t.yytext,!0,1+Number("TEMPLATE"!==n)),"TEMPLATE"===n&&e.pps(),n}case 8:{const n=t.yytext.endsWith("`")?"TPL_END":"TPL_CONTINUE";return t.yytext=this.toStringLiteral(t.yytext,!0,1+Number("TPL_END"!==n)),this.popState(),"TPL_END"===n&&e.pps(),n}case 9:this.parseError("Unexpected end of input");break;case 10:return 21;case 11:return e.pps(),22;case 12:return 61;case 13:return e.pps(),63;case 14:return 84;case 15:if("TPL_END"!==this.bracketStack[this.bracketStack.length-1])return e.pps(),85;this.unput("}"),this.begin("template");break;case 16:return t.yytext=this.toLiteral(t.yytext),57;case 17:return 36;case 18:return 37;case 19:return 30;case 20:return 35;case 21:return 33;case 22:return 32;case 23:return 34;case 24:return 25;case 25:return 26;case 26:return 95;case 27:return t.yytext=this.ident(t.yytext.slice(0,-1)),70;case 28:return t.yytext=this.ident(t.yytext.slice(1,-1)),72;case 29:return e.pps(),t.yytext=this.ident(t.yytext),14;case 30:return e.pps(),t.yytext=this.ident(t.yytext.slice(1)),15;case 31:return e.pps(),t.yytext=this.toNumberLiteral(t.yytext,!0),55;case 32:return e.pps(),t.yytext=this.toNumberLiteral(t.yytext),55;case 33:return e.pps(),t.yytext=this.toNumberLiteral(t.yytext,!0,!0),55;case 34:return e.pps(),t.yytext=this.toNumberLiteral(t.yytext,!1,!0),55;case 35:case 36:return e.pps(),t.yytext=this.toStringLiteral(t.yytext),54;case 37:return e.pps(),t.yytext=this.toRegExp(t.yytext),56;case 38:return e.pps(),51;case 39:return e.pps(),52;case 40:return e.pps(),53;case 41:return e.pps(),9;case 42:return 20;case 43:return 42;case 44:return 43;case 45:return 48;case 46:return 47;case 47:return 45;case 48:return 44;case 49:return 46;case 50:return 69;case 51:return 66;case 52:return 67;case 53:return 89;case 54:return e.pps(),e.pks(),68;case 55:return e.pps(),e.pks(),65;case 56:return 38;case 57:return 17;case 58:return 73;case 59:return 11;case 60:return 10;case 61:return 27;case 62:return 28;case 63:return 39;case 64:return 40;case 65:return 41;case 66:return 29;case 67:this.parseError(`Bad input on line ${t.yylloc.first_line} column ${t.yylloc.first_column}\n`+this.showPosition(),{text:t.yytext,token:"BAD_TOKEN"});break;case 68:return 5}},setInput(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=!1,this._backtrack=!1,this.done=!1,this.currentCondition="INITIAL",this.conditionStack=["INITIAL"],this.offset=0,this.yytext=this.match="",this.yyleng=0,this.yylineno=0,this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.yylloc.range=[0,0],this},parseError(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},input(){const e=this._input[this.offset],t=/\n|\r\n?|\u2028|\u2029/g.test(e);return this.offset++,this.yyleng++,this.yytext=this.match=this.yytext+e,t?(this.yylineno++,this.yylloc.last_line++,this.yylloc.last_column=0):this.yylloc.last_column++,this.yylloc.range[1]++,e},lineColumnForOffset(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.offset,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._input;const n=/\n|\r\n?|\u2028|\u2029/g;let r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=0;for(;null!==(r=n.exec(t));){if(!(r.index<e)){i+=e-a,a=-1;break}s++,i=0,a=r.index+r[0].length}return-1!==a&&(i+=e-a),{line:s,column:i}},setMatch(e,t){const n=this._input.slice(e,t),r=e!==this.offset?this.lineColumnForOffset(e):{line:this.yylloc.last_line,column:this.yylloc.last_column},s=e!==t?this.lineColumnForOffset(t-e,n,r.line,r.column):r;this.yytext=this.match=n,this.yyleng=t-e,this.offset=t,this.yylineno=s.line-1,this.yylloc={first_line:r.line,first_column:r.column,last_line:s.line,last_column:s.column},this.yylloc.range=[e,t]},less(e){const t=this.offset-this.match.length;this.setMatch(t,t+e)},unput(e){const t=this.match.length-e.length;if(!this.match.startsWith(e,t))throw new Error("Lexer#unput() should receive a part of matched text only");this.less(t)},more(){this._more=!0},reject(){throw new Error("reject() is allowed only when options.backtrack_lexer = true")},showPosition(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.offset-this.match.length;const t=this._input,n=Math.max(e-20,0),r=Math.min(e+20,t.length),s=(0===n?"":"...")+t.slice(n,e).replace(/\n|\r\n?|\u2028|\u2029/g,"\\n");return s+(t.slice(e,r).replace(/\n|\r\n?|\u2028|\u2029/g,"\\n")+(r===t.length?"":"..."))+`\n${"-".repeat(s.length)}^`},test_match(e,t){this._more=!1,this._backtrack=!1,this.setMatch(this.offset,this.offset+e[0].length),this.matches=e;const n=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]);return!n&&this._backtrack?(Object.assign(this,undefined),!1):(this.eof()||(this.done=!1),"number"===typeof n&&this.yy.parser?this.yy.parser.terminals_[n]:n||!1)},eof(){return this.offset===this._input.length},next(){if(this.done)return 1;let e,t;this.eof()&&(this.done=!0),this._more||(this.yytext="",this.match="");for(const n of this.conditions[this.currentCondition].rules){const r=this.rules[n],s=this._input.slice(this.offset);let i;if("function"===typeof r){const e=r(s,this.currentCondition);switch(typeof e){case"string":i=[e];break;case"number":i=[s.slice(0,e)];break;default:i=e}}else i=s.match(r);if(i&&(!e||i[0].length>e[0].length)){e=i,t=n;break}}return e?this.test_match(e,t):this.eof()?1:void this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex(){let e;for(;!e;)e=this.next();return e},begin(e){this.currentCondition=e,this.conditionStack.push(e)},pushState(e){this.begin(e)},popState(){return this.conditionStack.pop(),this.currentCondition=this.conditionStack.length?this.conditionStack[this.conditionStack.length-1]:"INITIAL"},topState(e){return(e=this.conditionStack.length-1-Math.abs(e||0))>=0?this.conditionStack[e]:"INITIAL"},stateStackSize(){return this.conditionStack.length}};return e}();function W(){this.yy={}}W.prototype={Parser:W,lexer:J,symbols_:{error:2,root:3,block:4,EOF:5,definitions:6,e:7,def:8,$:9,";":10,":":11,$ident:12,ident:13,IDENT:14,$IDENT:15,condConsequent:16,"?":17,condAlternate:18,query:19,"=>":20,"(":21,")":22,functionArgs:23,compareFunction:24,NOT:25,NO:26,"-":27,"+":28,"|":29,IS:30,assertion:31,IN:32,HAS:33,NOTIN:34,HASNO:35,AND:36,OR:37,"??":38,"*":39,"/":40,"%":41,"=":42,"!=":43,"<":44,"<=":45,">":46,">=":47,"~=":48,queryRoot:49,relativePath:50,"@":51,"#":52,$$:53,STRING:54,NUMBER:55,REGEXP:56,LITERAL:57,template:58,object:59,array:60,"[":61,sliceNotation:62,"]":63,"method()":64,".":65,".(":66,".[":67,"..":68,"..(":69,"METHOD(":70,arguments:71,"$METHOD(":72,",":73,functionArg:74,templateString:75,templateStart:76,templateTail:77,templateEnd:78,templateContinue:79,TEMPLATE:80,TPL_START:81,TPL_CONTINUE:82,TPL_END:83,"{":84,"}":85,objectEntries:86,objectEntry:87,objectEntryKeyLiteral:88,"...":89,arrayElements:90,arrayElement:91,assertionTerm:92,assertionList:93,compareExpr:94,ORDER:95,sliceNotationComponent:96,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",9:"$",10:";",11:":",14:"IDENT",15:"$IDENT",17:"?",20:"=>",21:"(",22:")",25:"NOT",26:"NO",27:"-",28:"+",29:"|",30:"IS",32:"IN",33:"HAS",34:"NOTIN",35:"HASNO",36:"AND",37:"OR",38:"??",39:"*",40:"/",41:"%",42:"=",43:"!=",44:"<",45:"<=",46:">",47:">=",48:"~=",51:"@",52:"#",53:"$$",54:"STRING",55:"NUMBER",56:"REGEXP",57:"LITERAL",61:"[",63:"]",65:".",66:".(",67:".[",68:"..",69:"..(",70:"METHOD(",72:"$METHOD(",73:",",80:"TEMPLATE",81:"TPL_START",82:"TPL_CONTINUE",83:"TPL_END",84:"{",85:"}",89:"...",95:"ORDER"},productions_:[0,[3,2],[4,2],[4,1],[4,1],[4,0],[6,1],[6,2],[8,2],[8,4],[8,2],[8,4],[13,1],[12,1],[16,2],[16,1],[18,2],[18,1],[18,0],[7,1],[7,2],[7,3],[7,4],[7,5],[7,1],[7,2],[7,2],[7,2],[7,2],[7,3],[7,4],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[19,1],[19,1],[49,1],[49,1],[49,1],[49,1],[49,1],[49,1],[49,1],[49,1],[49,1],[49,1],[49,1],[49,1],[49,3],[49,2],[49,2],[49,1],[49,1],[49,3],[49,4],[49,2],[49,2],[49,3],[49,3],[49,2],[49,2],[49,3],[49,2],[49,3],[50,3],[50,4],[50,4],[50,3],[50,3],[50,4],[50,4],[50,3],[50,3],[50,4],[64,2],[64,3],[64,2],[64,3],[71,1],[71,3],[74,1],[23,1],[23,3],[58,1],[58,2],[77,1],[77,2],[77,2],[77,3],[75,1],[76,1],[79,1],[78,1],[59,2],[59,3],[59,4],[59,3],[59,4],[59,5],[86,1],[86,3],[88,1],[88,1],[88,1],[87,1],[87,1],[87,1],[87,1],[87,1],[87,3],[87,3],[87,3],[87,2],[87,2],[87,2],[87,5],[87,1],[87,2],[90,1],[90,3],[91,1],[91,1],[91,2],[60,2],[60,3],[60,4],[31,1],[31,2],[31,3],[31,4],[92,1],[92,1],[92,1],[92,1],[93,1],[93,3],[93,3],[24,1],[24,3],[94,2],[62,1],[62,2],[62,2],[62,3],[96,1],[96,2]],table:function(e){function t(e){const t=[];for(let r=0;r<e.length;r++){const s=n[e[r]];if(32&s){const i=n[e[++r]];t.push(31&s|i<<5)}else t.push(s)}return t}const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789~|=".split("").reduce(((e,t,n)=>(e[t]=n,e)),Object.create(null)),[r,s,...i]=e.split("=").map((function(e){const t=e.match(/[\x20-\x2f]/g);for(let n=t?Math.max(...t.map((e=>e.charCodeAt()-32))):-1;n>=0;n--){const t=(32+n).toString(16);let r;e=e.replace(new RegExp("\\[\\x"+t+"(.+?)\\]"),((e,t)=>r=t)).replace(new RegExp("\\x"+t,"g"),r)}return e=e.replace(/<([^>]+?)>/g,((e,t)=>{let r=n[t[0]],s=1;return r>>5===1&&(r=31&r|n[t[1]]<<5,s=2),t.slice(s).repeat(r)}))})),a=s.split(";").map((e=>{const t=[];for(let r=0;r<e.length;r++)for(let s=0,i=n[e[r]];s<3;s++)t.push(i>>2*s&3);return t})),o=i.map(t),u=t(r).map((e=>{const t=a[e],n=Object.create(null);for(let r=0;r<t.length;r++){const e=t[r];if(0!==e){const t=o[e-1].shift();n[r]=1===e?t:[e-1,t]}}return n}));for(let l=0;l<o[3].length;l+=2)u[o[3][l]][o[3][l+1]]=[3];return u}('ABCDEFGHIJKHHHHLL<NM>NOPMMQRSQRTMUVWXYYMZaEFTO<TH>PMbQRSQRcMMHdefgBhBiBHj[ BjBkBk]BFHFHlBMmBnBoBpBqBrBMMsBtBMMMMXMWMMuB[!lBMMuB]vBgBMMwBUMZMxByBzB0B1B2B3B4BH5<DB6>BvBXe7BXevBgBM<E8B>9B~ <DB|>BgCgC<EhC>gCMMiC<C!>cHdjCMfMkClClCMMmCnCnBoCpCMtBqCrCvBMMMvBMUMMsCMxBHtCHtCtCHuCvCTXHXvB<FM>cHhBhBMFFMpBpCnCqCMOOMMzBzB2BMsCwCtCtCxC7BcMrCrCHMHtCtC=A1[ V[!C["lmkCpqC]]]<FA>[#[$[%[&[\'UqqWJkq]K]C][([)FgCCAAE];]]A];Ag;AwU[*ClmkOpqC]<FA>[+[,U[-qqWJnqK]]C(A]wAA[.A[/kAMAqi]]<Fq>CAAAAD<JA>g;AwADwzwP8|D<GA>||DMz|PDAwDPw;AwA8AwAMA|z<F|>DAAAIjqCMAA8MAAw;AAE!<FA>#wA8AwgMA|z<F|>DAAAMz|DMAA8MAAw;AAVClmkapqC<FA>&S(AwA8AwAMA|z<F|>DAAAMz|DIAA8MAAw;AwAoAwAMA|z<F|>DAAAMz|DMAA8MAAw;AwA8AwAMA|z<F|>DAAAMz|DMAA8MAAw;AAEi"<FA>UqqWZmqKCFgCCgFEB;AAAChCACIAE<IA>C<KA>Q;AwAsAwBMA|z<F|>DAAAMz|DMAA8MAAw;AAAAk<QA>EAIC;AEV*<FA>#E <FA>+A <FA>#AE!<FA>%VlqCAAE;AARClC<MA>KCIEAICAAAYl;AwE~lmkOp6y<F|>X-OFg~OAA0;AwA|wzwP8|z<F|>D||DMz|PPAw|PAAw;AAEClmkKpqC<FA>\'aC(AAADwzwD8|D<GA>||DMw|PDAw|D;M;AAEi"<FA>UqqWZmqKC)B;AwA8.<Fq>CAAAMz|DMAA8MAA<Cg;AAAAAA>AI<QA>I;<FA>kAIAqi<Fq>C<OA>g;AAU!<FA>$<HA>M<QA>M;AAA8AwgMA|z<F|>DAAAMw|DM<GA>w;AwA8A0AMA6jq|qqqCAAAMz|DMAA8MAAw;AwA8A0AMA|z||q||DAAAMz|DMAA8MAAw<C;AAAAAAAAAAAAAAAAAAAAAC>AAI;AAAg<RA>D<KA>B;AAAgAkAAAqi<Fq>CAAAADAAM<GA>gB;<VA>DAAM;AAEy"<FA>+AE!<FA>,O(AAAChCACA<KA>C<KA>Q;AAAChCACIAE<IA>C<KA>QB;<HA>I;AwA8AkAMA6i<Fq>CAAAMz|DMAA8MAAw;<FA>kAAAqi<Fq>C<JA>FoAAAg;<YA>IAAAI;AAQClC<MA>KCIEAICAAAYl;<YA>MAAAM;AAAo<UA>MAAAM;AAEq"<FA>&OFgCOAAE;AAEi"<FA>&OFgCOAAE;AAE!<FA>&OFgCOAAE;AAAg<UA>MAAAM;AAAClmECAgC<FA>&OFgCO;AAAw<UA>MAAAM;<FA>/<Fq>C<HA>M<GA>g;AwA8A0AMA6z||qqqCAAAMz|DMAA8MAAw;AwA8A0AMA6jqvqqqCAAAMz|DMAA8MAAw;AwA8A0AMA6jquqqqCAAAMz|DMAA8MAAw;AwA8A0AMA|z<F|>DAAAMz|DMAA8MAAw;AwA8A0AMA6z||qvqDAAAMz|DMAA8MAAw;AwA8A0AMA6z||q||DAAAMz|DMAA8MAAw;AAAgAkAAAqi<Fq><CCAAAA><FA>gB;<FA>C<SA>Q;<FA>kAAAqi<Fq>C<OA>g;AAAIAkAAAqi<Fq>C<OA>g;AAE!<FA>UqqWJmqKCFgCCgEE;<VA>D;AAAwAkAAAqi<Fq>CAAAAD<JA>g;<FA>kAAAqi<Fq>CAAAADAAM<GA>g;<HA>IAAAAK;<HA>MAAAAP;AAAClC<MA>KCIEAICAAAIl;<FA>kAAAqi<Fq>C<HA>MAAAMAAg;<FA>kAAAqi<Fq><CCAAAA><FA>g;<UA>IgqCMAAAM;AAAIAkAAAqi<Fq>C<HA>MAAAMAAg;AAAg=BC[ D[!E["[#F[$QhBgBG]][%[&[\'[(KRSbcd]iB]pBqB]T]]]]zB[)0B$%qC]y[*C[[,+[-0ChBgB]]G%]]5C4C#3C\'6CpBqBT9*~*|*gD+pD-G(lD[.iBpBqB]nDqDToDzDtDuD2D4D5D6D 7D 8D9D~D gE|D"jE-G&hEiEkETpEF[/sEtEuE]oEqEvE1E+4E-G\'3EpBqBT4E-G\'6EpBqBTqC8E7!zD9EuD~E+|E+gF+hF+iF+jF+kF+lF+mF+nF+oF+pF+qF+rF+sF+tF+uF+vF+wF+xFzF-G(0F.ToD1F2F3F 4F 5F6F7F qC8F+qChG0B$%jG-G&iG<EqC>kG+lG+pGqCqGrG+sG+zDtGzDwGuDvGxG+qC1G)2G3GjE-G&4GiEkET0B/8GqEvE~G+gH+hH+jH,kHRSbcd.qCqCqCpH0B$%<UqC>qGqCvH+xH<EqC>4H-G&3HT5HqCqCzDwGuD6HqCqCjE-G&~HiEkETiItEuEgIvElI+qCmI+qCqCnI+qC5C4C"pI+qCqCqI+qCzDsIuDzDtIuD~G+iItEuEgIvE<FqC>xI+yI+qCqC=[ [!["P[#[$[%[&[\'tBIsBHJ]LMNO][(oB[)fUVWXYZae]]][*jBkBlBmBnBuBvBwBxB]]r]]B]y][+B[,![-[.sB|B~B][/1B2B3B4B5B6B7B8B9BgChCiCjCkClCmCnCoCpC]]]rC]sCtCuCvCwCxCzC#B1CPtB7CsBHJ2CLMNO(*rB8C<EzC#B>hDiDjDkDzCrD%mD*rBsDyDxD1DwDvD0D3D<CtBuBvB!!>zC$mElErBrEtB1DyEzE0EwEuBvBnExEzC&)*rBzC\'2ELMNO(*rBzC\'5ELMNO(*rB-rC DxD1DwDvD0D<TzC#B>3DzCrD%yF*rBtBuBv<CB">BtBuBv+zC#B9F~F|FsBgG|B~B/rC!1CzC#B<C|B~B3B4B5B6BgChCiCjCkClCmCnCoCpC><CgChCiC><CzC#B>mGnGoGrDrD-rC<CzC#B>yDxD1DuG0DyDxD1DwDvD0DzC&)*rByGzG0G.2B3B4B5B6B7B8B9BgChCiCjCkClCmCnCoCpC,mElErCzC$mElErB6G5GrEtB1DyEzE0EwEuBvB7GxEhDiDzCjD9G#BzC|G#BzC#BiHzC#BzCtB1DsBlH(*rB.2B3B4B5B6B7B8B9BgChCiCjCkClCmCnCoCpCmHnH-rCoHnH.2B3B4B5B6B7B8B9BgChCiCjCkClCmCnCoCpC!<E|B~BgChCiCjCkClCmCnCoCpC>|B~B3B4B5B6B9BgChCiCjCkClCmCnCoCpC|B~B3B4B5B6B7B9BgChCiCjCkClCmCnCoCpC|B~B3B4B5B6BgChCiCjCkClCmCnCoCp<CCgChCi><CC|B~BgChCiClCmCnCo><FC|B~BgChCi>ClCmCnCoCrD-qHrCrHsHtHuH-rCzC#BwHyHsBzH|B~B/rC-rC0H-rC1H-rCzC%2H*rBsDrD<C-rC>yDxD1DwDvD0D7H8H9H<C.2B3B4B5B6B7B8B9BgChCiCjCkClCmCnCoCpC>zC$mElErBhItB1DyEzE0EwEuBvB|HxEkIjI<CzC#B-rC>-rCzC#B-oIrCsCtCuCvCwCxC!zC#B.2B3B4B5B6B7B8B9BgChCiCjCkClCmCnCoCpC-rCzC#B-rCrI8H9H<CyDxD1DwDvD0D>zCuI#BhItB1DyEzE0EwEuBvBvIxE1H<D-rC>wI<C-rC><CzC#B><C-rC>=FDDDEEE<jBG><gBT><mBN><lBY><kB4B><kB6B><mB0B><mB1B><mB7E><mB2B><mB3B><mB5B><mB7B><mB8B><mB9B><mB~B><mB|B><mBgC><mBhC><lBS><mBlC><mBmC>FFF<mBlD><cP><5BM><mBrD><gBsD>BCCC<jBH><lBS><mB9E>FFF<PU><mB4B><mB6B>jDjDNNNiD<bN>iDN<WZ><Wa><jBb><jBc><jBI><jBK><mBtE>~EqEqEoEoEiFiFrErE<mBjC><mBwE><mB0E><mB1E><mB2E><mB3E><5BN><mBkC><cR><mBpC><mBqC><mBtC><mBuC><RwC><mBmD><mBnD><mBuD><gBtD><mBvD>1D1[ D6D6D7D7D]8D8D9D9D~D~DmEmE<D3D><D4D><D5D><RO><5B8C>gDgD<5B~C><Rd><mBf><agB><ahB><aiB><ajB><VkB><UlB><WmB><jBnB><jBoB><mBpB><mBqB><mBrB><dsB><dtB><hBuB><hBvB><hBwB><hBxB><dyB><mBzB><mByC><mB1C><mB2C><mB5C><mB6C><PV><mBnC><mB8E><mBiC><mBuE>|EgFjFjFsEsE<mBxE><D4E><RQ><mBrC><mBsC><mBvC><RxC><mBoD><mBpD><mBwD><mByD>iEiEjEjEkEkEnEnE<5B9C><5B|C><Re><mBzC><mB0C><mB3C><mB4C><mB7C><PW>kDkDiDiD<mBoC><jBJ><jBL><mBvE>pEpEqEqEhF<mByE><mBqD><mBxD>2D2 <mBzD>hEhE|D|DgEgEhDhD<PX><mBzE><D5E><D6E><mB0D>hEhElElE=BB'),defaultActions:{50:[2,1],201:[2,159],249:[2,161]},performAction(e,t,n,r,s,i,a){const o=i.length-1;switch(s){case 1:return r.buildResult(i[o-1]);case 2:this.$={type:"Block",definitions:i[o-1],body:i[o],range:this._$.range};break;case 3:this.$={type:"Block",definitions:i[o],body:{type:"Placeholder",range:[a[o].range[1],a[o].range[1]]},range:this._$.range};break;case 4:this.$={type:"Block",definitions:[],body:i[o],range:this._$.range};break;case 5:this.$={type:"Block",definitions:[],body:{type:"Placeholder",range:[a[o].range[1],a[o].range[1]]},range:this._$.range};break;case 6:case 96:case 99:case 101:case 117:case 136:case 152:case 155:this.$=[i[o]];break;case 7:i[o-1].push(i[o]);break;case 8:this.$={type:"Definition",declarator:{type:"Declarator",name:null,range:a[o-1].range},value:null,range:this._$.range};break;case 9:this.$={type:"Definition",declarator:{type:"Declarator",name:null,range:a[o-3].range},value:i[o-1],range:this._$.range};break;case 10:this.$={type:"Definition",declarator:{type:"Declarator",name:i[o-1].name,range:a[o-1].range},value:null,range:this._$.range};break;case 11:this.$={type:"Definition",declarator:{type:"Declarator",name:i[o-3].name,range:a[o-3].range},value:i[o-1],range:this._$.range};break;case 12:case 13:case 98:case 148:case 149:this.$={type:"Identifier",name:i[o],range:this._$.range};break;case 14:case 16:case 163:this.$=i[o];break;case 15:case 17:case 18:case 162:this.$=null;break;case 19:case 52:case 53:case 64:case 65:case 138:break;case 20:case 22:this.$={type:"Function",arguments:[],body:i[o],range:this._$.range};break;case 21:this.$={type:"Function",arguments:[{type:"Identifier",name:i[o-2]}],body:i[o],range:this._$.range};break;case 23:this.$={type:"Function",arguments:i[o-3],body:i[o],range:this._$.range};break;case 24:this.$={type:"CompareFunction",compares:i[o],range:this._$.range};break;case 25:case 26:case 27:case 28:case 67:this.$={type:"Prefix",operator:i[o-1],argument:i[o],range:this._$.range};break;case 29:this.$={type:"Pipeline",left:i[o-2],right:i[o],range:this._$.range};break;case 30:this.$={type:"Pipeline",left:i[o-3],right:{type:"Block",definitions:i[o-1],body:i[o]},range:this._$.range};break;case 31:this.$={type:"Postfix",operator:i[o],argument:i[o-2],range:this._$.range};break;case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:case 50:this.$={type:"Binary",operator:i[o-1],left:i[o-2],right:i[o],range:this._$.range};break;case 51:this.$={type:"Conditional",test:i[o-2],consequent:i[o-1],alternate:i[o],range:this._$.range};break;case 54:this.$={type:"Data",range:this._$.range};break;case 55:this.$={type:"Context",range:this._$.range};break;case 56:this.$={type:"Current",range:this._$.range};break;case 57:this.$={type:"Arg1",range:this._$.range};break;case 58:this.$={type:"Reference",name:i[o],range:this._$.range};break;case 59:case 60:case 61:case 62:case 107:case 108:case 109:case 110:case 119:case 120:case 121:this.$={type:"Literal",value:i[o],range:this._$.range};break;case 63:this.$={type:"Template",values:i[o],range:this._$.range};break;case 66:this.$={type:"SliceNotation",value:null,arguments:i[o-1],range:this._$.range};break;case 68:this.$={type:"Conditional",test:null,consequent:i[o-1],alternate:i[o],range:this._$.range};break;case 69:case 73:this.$={type:"GetProperty",value:null,property:i[o],range:this._$.range};break;case 70:case 74:this.$={type:"MethodCall",value:null,method:i[o],range:this._$.range};break;case 71:this.$={type:"Parentheses",body:i[o-1],range:this._$.range};break;case 72:this.$={type:"Parentheses",body:{type:"Block",definitions:i[o-2],body:i[o-1]},range:this._$.range};break;case 75:this.$={type:"Map",value:null,query:i[o-1],range:this._$.range};break;case 76:this.$={type:"Filter",value:null,query:i[o-1],range:this._$.range};break;case 77:this.$={type:"MapRecursive",value:null,query:{type:"GetProperty",value:null,property:i[o]},range:this._$.range};break;case 78:this.$={type:"MapRecursive",value:null,query:{type:"MethodCall",value:null,method:i[o]},range:this._$.range};break;case 79:this.$={type:"MapRecursive",value:null,query:i[o-1],range:this._$.range};break;case 80:this.$={type:"Pipeline",left:null,right:i[o],range:this._$.range};break;case 81:this.$={type:"Pipeline",left:null,right:{type:"Block",definitions:i[o-1],body:i[o]},range:this._$.range};break;case 82:this.$={type:"Pick",value:i[o-2],getter:null,range:this._$.range};break;case 83:this.$={type:"Pick",value:i[o-3],getter:i[o-1],range:this._$.range};break;case 84:this.$={type:"SliceNotation",value:i[o-3],arguments:i[o-1],range:this._$.range};break;case 85:this.$={type:"GetProperty",value:i[o-2],property:i[o],range:this._$.range};break;case 86:this.$={type:"MethodCall",value:i[o-2],method:i[o],range:this._$.range};break;case 87:this.$={type:"Map",value:i[o-3],query:i[o-1],range:this._$.range};break;case 88:this.$={type:"Filter",value:i[o-3],query:i[o-1],range:this._$.range};break;case 89:this.$={type:"MapRecursive",value:i[o-2],query:{type:"GetProperty",value:null,property:i[o]},range:this._$.range};break;case 90:this.$={type:"MapRecursive",value:i[o-2],query:{type:"MethodCall",value:null,method:i[o]},range:this._$.range};break;case 91:this.$={type:"MapRecursive",value:i[o-3],query:i[o-1],range:this._$.range};break;case 92:this.$={type:"Method",reference:{type:"Identifier",name:i[o-1],range:[a[o-1].range[0],a[o-1].range[1]-1]},arguments:[],range:this._$.range},this._mn=i[o-1];break;case 93:this.$={type:"Method",reference:{type:"Identifier",name:i[o-2],range:[a[o-2].range[0],a[o-2].range[1]-1]},arguments:i[o-1],range:this._$.range},this._mn=i[o-2];break;case 94:this.$={type:"Method",reference:{type:"Reference",name:{type:"Identifier",name:i[o-1],range:[a[o-1].range[0],a[o-1].range[1]-1]},range:[a[o-1].range[0],a[o-1].range[1]-1]},arguments:[],range:this._$.range},this._mn=i[o-1];break;case 95:this.$={type:"Method",reference:{type:"Reference",name:{type:"Identifier",name:i[o-2],range:[a[o-2].range[0],a[o-2].range[1]-1]},range:[a[o-2].range[0],a[o-2].range[1]-1]},arguments:i[o-1],range:this._$.range},this._mn=i[o-2];break;case 97:case 100:case 118:case 137:case 156:i[o-2].push(i[o]);break;case 102:this.$=[i[o-1],...i[o]];break;case 103:case 158:this.$=[null,i[o]];break;case 104:case 160:this.$=[i[o-1],i[o]];break;case 105:this.$=[null,i[o-1],...i[o]];break;case 106:this.$=[i[o-2],i[o-1],...i[o]];break;case 111:case 114:this.$={type:"Object",properties:[],range:this._$.range};break;case 112:this.$={type:"Object",properties:i[o-1],range:this._$.range};break;case 113:this.$={type:"Object",properties:i[o-2],range:this._$.range};break;case 115:this.$={type:"Block",definitions:i[o-2],body:{type:"Object",properties:i[o-1]},range:this._$.range};break;case 116:this.$={type:"Block",definitions:i[o-3],body:{type:"Object",properties:i[o-2]},range:this._$.range};break;case 122:this.$={type:"ObjectEntry",key:{type:"Current"},value:null,range:this._$.range};break;case 123:this.$={type:"ObjectEntry",key:{type:"Reference",name:i[o]},value:null,range:this._$.range};break;case 124:case 126:this.$={type:"ObjectEntry",key:i[o],value:null,range:this._$.range};break;case 125:this.$={type:"ObjectEntry",key:{type:"Literal",value:this._mn},value:i[o],range:this._$.range};break;case 127:case 128:this.$={type:"ObjectEntry",key:i[o-2],value:i[o],range:this._$.range};break;case 129:this.$={type:"ObjectEntry",key:{type:"Identifier",name:"$"+i[o-2].name},value:i[o],range:this._$.range};break;case 130:this.$={type:"ObjectEntry",key:i[o-1],value:{type:"Pipeline",left:{type:"Reference",name:i[o-1]},right:i[o]},range:this._$.range};break;case 131:this.$={type:"ObjectEntry",key:i[o-1],value:{type:"Pipeline",left:{type:"GetProperty",value:null,property:i[o-1]},right:i[o]},range:this._$.range};break;case 132:this.$={type:"ObjectEntry",key:{type:"Literal",value:this._mn},value:{type:"Pipeline",left:i[o-1],right:i[o]},range:this._$.range};break;case 133:this.$={type:"ObjectEntry",key:i[o-3],value:i[o],range:this._$.range};break;case 134:this.$={type:"Spread",query:null,array:!1,range:this._$.range};break;case 135:this.$={type:"Spread",query:i[o],array:!1,range:this._$.range};break;case 139:this.$={type:"Spread",query:null,array:!0,range:this._$.range};break;case 140:this.$={type:"Spread",query:i[o],array:!0,range:this._$.range};break;case 141:this.$={type:"Array",elements:[],range:this._$.range};break;case 142:this.$={type:"Array",elements:i[o-1],range:this._$.range};break;case 143:this.$={type:"Array",elements:i[o-2],range:this._$.range};break;case 144:this.$={type:"Assertion",negation:!1,assertion:i[o],range:this._$.range};break;case 145:this.$={type:"Assertion",negation:!0,assertion:i[o],range:this._$.range};break;case 146:this.$={type:"Assertion",negation:!1,assertion:i[o-1],range:this._$.range};break;case 147:this.$={type:"Assertion",negation:!0,assertion:i[o-1],range:this._$.range};break;case 150:this.$={type:"Method",reference:{type:"Reference",name:i[o]},arguments:[],range:this._$.range};break;case 151:this.$={type:"Identifier",name:String(i[o]),range:this._$.range};break;case 153:case 154:i[o-2].push(i[o-1],i[o]);break;case 157:this.$={type:"Compare",query:i[o-1],order:i[o],range:this._$.range};break;case 159:this.$=[null,i[o-1],i[o]];break;case 161:this.$=[i[o-2],i[o-1],i[o]]}},trace(){this.DEBUG&&Jison.print(...arguments)},parseError(e,t){if(!t.recoverable){const n=new Error(e);throw n.hash=t,n}this.trace(e)},parse(e){const t=e=>{l.length-=2*e,c.length-=e,p.length-=e},n=()=>{let e=r.lex()||1;return"number"!==typeof e&&(e=this.symbols_[e]||e),e},r=Object.create(this.lexer),s=r.options&&r.options.ranges,i={...this.yy,parser:this,lexer:r};r.setInput(e,i),"function"===typeof i.parseError&&(this.parseError=i.parseError),"undefined"==typeof r.yylloc&&(r.yylloc={});const a=this.table,o={};let u=r.yylloc;const l=[0],c=[null],p=[u];let h,f,g="",y=0,d=0,A=0;for(var m=arguments.length,C=new Array(m>1?m-1:0),b=1;b<m;b++)C[b-1]=arguments[b];for(;;){let e,m=l[l.length-1];if(this.defaultActions[m]?e=this.defaultActions[m]:(null!==h&&"undefined"!=typeof h||(h=n()),e=a[m]&&a[m][h]),!e||!e[0]){let s,i="";if(!A){const e=[];for(const t in a[m])t in this.terminals_&&t>2&&e.push("'"+this.terminals_[t]+"'");i=r.showPosition?"Parse error on line "+(y+1)+":\n"+r.showPosition()+"\nExpecting "+e.join(", ")+", got '"+(this.terminals_[h]||h)+"'":"Parse error on line "+(y+1)+": Unexpected "+(1===h?"end of input":"'"+(this.terminals_[h]||h)+"'"),this.parseError(i,{text:r.match,token:this.terminals_[h]||h,line:r.yylineno,loc:u,expected:e})}if(3===A){if(1===h||1===f)throw new Error(i||"Parsing halted while starting to recover from another error.");d=r.yyleng,g=r.yytext,y=r.yylineno,u=r.yylloc,h=n()}if(!1===s)throw new Error(i||"Parsing halted. No suitable error recovery rule available.");t(s),f=2==h?null:h,h=2,m=l[l.length-1],e=a[m]&&a[m][2],A=3}if(Array.isArray(e[0])&&e.length>1)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+h);switch(e[0]){case 1:l.push(h),c.push(r.yytext),p.push(r.yylloc),l.push(e[1]),h=null,f?(h=f,f=null):(d=r.yyleng,g=r.yytext,y=r.yylineno,u=r.yylloc,A>0&&A--);break;case 2:{const n=this.productions_[e[1]][1],r=p[p.length-(n||1)],u=p[p.length-1];o.$=c[c.length-n],o._$={first_line:r.first_line,last_line:u.last_line,first_column:r.first_column,last_column:u.last_column},s&&(o._$.range=[r.range[0],u.range[1]]);const h=this.performAction.call(o,g,d,y,i,e[1],c,p,...C);if("undefined"!==typeof h)return h;n&&t(n),l.push(this.productions_[e[1]][0]),c.push(o.$),p.push(o._$),l.push(a[l[l.length-2]][l[l.length-1]]);break}case 3:return!0}}}};const Y=function(e){function t(e,t){Object.entries(t).forEach((t=>{let[n,r]=t;return e[n]=r(e[n])}))}const n=new Map([["EOF",["<end of input>"]],["IDENT",["ident"]],["$IDENT",["$ident"]],["NOT",["'not'"]],["NO",["'no'"]],["IS",["'is'"]],["IN",["'in'"]],["HAS",["'has'"]],["NOTIN",["'not in'"]],["HASNO",["'has no'"]],["AND",["'and'"]],["OR",["'or'"]],["STRING",["string"]],["TPL_START",["template"]],["TEMPLATE",["template"]],["NUMBER",["number"]],["REGEXP",["regexp"]],["LITERAL",["'true'","'false'","'null'","'undefined'","'NaN'","'Infinity'"]],["ORDER",["'asc'","'desc'","'ascN'","'descN'"]],["METHOD(",["'method('"]],["$METHOD(",["'$method('"]]]),r=e=>n.get(e)||`'${e}'`,s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(!t.recoverable){if(Array.isArray(t.inside)){const e=n.lexer.offset-n.lexer.match.length;n.lexer.setMatch(e+t.inside[0],e+t.inside[1])}const s=n.lexer.yylloc,i=[e.split(/\n/)[0],"",n.lexer.showPosition()],a=Array.isArray(t.expected)?[...new Set([].concat(...t.expected.map((e=>r(e.slice(1,-1))))))]:null;a&&i.push("","Expecting "+a.join(", ")+" got "+r(t.token));const o=new SyntaxError(i.join("\n"));throw o.details={rawMessage:e,text:t.text,token:t.token,expected:a,loc:{range:s.range,start:{line:s.first_line,column:s.first_column,offset:s.range[0]},end:{line:s.last_line,column:s.last_column,offset:s.range[1]}}},o}this.trace(e)},i=new Set(["\n","\r","\u2028","\u2029"]),a=new Map([["undefined",void 0],["null",null],["false",!1],["true",!0],["Infinity",1/0],["NaN",NaN]]);Object.assign(e.lexer,{ident:e=>e.replace(/\\u[0-9a-fA-F]{4}/g,(e=>String.fromCharCode(parseInt(e.slice(2),16)))),toLiteral:e=>a.get(e),toNumberLiteral(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t){const t=e.match(n?/(?:^|[^0-9a-fA-F])_|_(?:[^0-9a-fA-F]|$)/:/(?:^|\D)_|_(?:\D|$)/);if(t){const e=t[0],n=t.index+Number("_"===e[1]),r="__"===e?"Only one underscore is allowed":"Wrong underscore";this.parseError(r+" as numeric separator",{inside:[n,n+1]})}e=e.replace(/_/g,"")}return n?parseInt(e,16):parseFloat(e)},toStringLiteral(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const r=e.length-n;let s="";for(let a=1;a<r;a++){if(!t&&i.has(e[a])&&this.parseError("Invalid line terminator",{inside:[a,a+1]}),"\\"!==e[a]){s+=e[a];continue}a===r-1&&this.parseError("Invalid backslash",{inside:[a,a+1]});const n=e[++a];switch(n){case"\r":a+="\n"===e[a+1];break;case"\n":case"\u2028":case"\u2029":break;case"0":s+="\0";break;case"b":s+="\b";break;case"n":s+="\n";break;case"r":s+="\r";break;case"f":s+="\f";break;case"t":s+="\t";break;case"v":s+="\v";break;case"u":{const[t=""]=e.slice(a+1,a+5).match(/^[0-9a-f]*/i)||[];if(4===t.length){s+=String.fromCharCode(parseInt(t,16)),a+=4;break}this.parseError("Invalid Unicode escape sequence",{inside:[a-1,Math.min(a+1+t.length,r)]});break}case"x":{const[t=""]=e.slice(a+1,a+3).match(/^[0-9a-f]*/i)||[];if(2===t.length){s+=String.fromCharCode(parseInt(t,16)),a+=2;break}this.parseError("Invalid hexadecimal escape sequence",{inside:[a-1,Math.min(a+1+t.length,r)]});break}default:s+=n}}return s},toRegExp(e){const t=e.lastIndexOf("/")+1,n=e.substr(t);return n.split("").forEach(((e,n,r)=>{const s=r.indexOf(e,n+1);-1!==s&&this.parseError("Duplicate flag in regexp",{inside:[t+s,t+s+1]})})),new RegExp(e.substr(1,e.lastIndexOf("/")-1),n)}}),t(e.lexer,{setInput:e=>function(t,n){const r=[];return n.commentRanges=r,n.buildResult=e=>({ast:e,commentRanges:r}),n.parseError=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return s.call(this,...t,n)},n.pks=()=>{this.eof()||this.begin("preventKeyword")},n.pps=()=>{this.eof()||this.begin("preventPrimitive")},this.bracketStack=[],this.prevToken=null,this.prevYylloc={first_line:1,last_line:1,first_column:0,last_column:0,range:[0,0]},e.call(this,t,n)}});const o=new e.Parser;o.lexer={...e.lexer},o.yy={...e.yy};const u=["AND","OR","IN","NOTIN","HAS","HASNO","IS"],l=[...u,"NOT","NO","ORDER"],c=["+","-","*","/","%","|","=","!=","~=",">=","<=","<",">"],p=[null,"?",":",";",",",".","..","(",".(","..(","METHOD(","$METHOD(","[",".[","=>",...c,...u,"NOT","NO"],h=[",","?",":",";","EOF","]",")","}","TPL_CONTINUE","TPL_END",...c,...u,"ORDER"],f=new Map(p.map((e=>[e,new Set(h)])));for(const A of[".(","..(","METHOD(","$METHOD("])f.get(A).delete(")");for(const A of["[",".["])f.get(A).delete("]");t(o.lexer,{lex:e=>function(){const t=this.offset,n=e.call(this);if(f.has(this.prevToken)&&f.get(this.prevToken).has(n)){const e={first_line:this.prevYylloc.last_line,last_line:this.yylloc.first_line,first_column:this.prevYylloc.last_column,last_column:this.yylloc.first_column,range:[this.prevYylloc.range[1],this.yylloc.range[0]]};if(this.unput(this.match),this.pushState("preventPrimitive"),this.done=!1,this.yytext="",this.yylloc=this.prevYylloc=e,t!==this.offset&&l.includes(n))switch(this._input[t]){case" ":case"\t":e.last_column--,e.range[1]--;break;case"\n":{const n=this._input.lastIndexOf("\n",t-1);e.last_line--,e.last_column=-1===n?e.last_column-1:t-n,e.range[1]--;break}}return this.prevToken="IDENT"}if(this.prevYylloc=this.yylloc,l.includes(n))switch(this._input[this.offset]){case" ":case"\t":this.prevYylloc={...this.prevYylloc,last_column:this.prevYylloc.last_column+1,range:[this.prevYylloc.range[0],this.prevYylloc.range[1]+1]};break;case"\n":this.prevYylloc={...this.prevYylloc,last_line:this.prevYylloc.last_line+1,last_column:0,range:[this.prevYylloc.range[0],this.prevYylloc.range[1]+1]}}return this.prevToken=n}});const g=new Map([["(",")"],[".(",")"],["..(",")"],["METHOD(",")"],["$METHOD(",")"],["[","]"],[".[","]"],["{","}"],["TPL_START","TPL_END"]]),y=new Set([")","]","}","TPL_END"]),d=e=>function(){const t=e.call(this);if(y.has(t)){const e=this.bracketStack.pop();e!==t&&this.parseError(`Expected "${e}" got "${t}"`)}return g.has(t)&&this.bracketStack.push(g.get(t)),t};return t(e.lexer,{lex:d}),t(o.lexer,{lex:d}),{parse:(t,n)=>n?o.parse(t):e.parse(t),*tokenize(t,n,r){const s=n?o:e,i=Object.create(s.lexer);for(i.setInput(t,{parser:s});!i.done;){const e={type:i.lex(),value:i.match,offset:i.yylloc.range[0]};r&&(e.loc={range:i.yylloc.range,start:{line:i.yylloc.first_line,column:i.yylloc.first_column},end:{line:i.yylloc.last_line,column:i.yylloc.last_column}}),yield e}}}}(new W),K=Y;function Q(e,t){t.put(t.scope.arg1?"arguments[1]":"undefined")}function Z(){}function V(e,t){t.put("$$")}function X(e,t){0===e.elements.length&&t.queryRoot(e.range[0]+1,e.range[1]-1)}function ee(e,t){t.put("["),t.list(e.elements,","),t.put("]")}function te(e,t){t.list(e.elements)}function ne(e,t){t.put("["),t.list(e.elements,","),t.put("]")}function re(e,t){Array.isArray(e.assertion)||(t.range(e.assertion.range,"var"),t.range(e.assertion.range,"assertion"))}function se(e,t){if(Array.isArray(e.assertion)){t.put(e.negation?"!(":"(");for(let n=0;n<e.assertion.length;n++)if(n%2===0)t.node(e.assertion[n]);else switch(e.assertion[n]){case"and":t.put("&&");break;case"or":t.put("||");break;default:t.error("Bad conjuction operator in assertion",e)}t.put(")")}else switch(e.negation&&t.put("!"),e.assertion.type){case"Identifier":e.assertion.name?(t.put("!!"),t.tolerant&&t.put("(typeof "),t.put("a."),t.put(e.assertion.name),t.tolerant&&(t.put('==="function"?a.'),t.put(e.assertion.name)),t.put(".call(mctx,"),t.nodeOrCurrent(),t.put(")"),t.tolerant&&t.put(":false)"),t.usedAssertions.has(e.assertion.name)?t.usedAssertions.get(e.assertion.name).push(e.assertion.range):t.usedAssertions.set(e.assertion.name,e.assertion.range)):t.put("false");break;case"Method":t.put("!!"),t.node(e.assertion);break;default:t.error('Unknown assertion node type "'+e.assertion.type+'"',e.assertion)}}function ie(e,t){if(Array.isArray(e.assertion))for(let n=0;n<e.assertion.length;n++)n%2===0&&t.node(e.assertion[n]);else t.node(e.assertion)}function ae(e,t){if(e.negation&&t.put("not "),Array.isArray(e.assertion)){t.put("(");for(let n=0;n<e.assertion.length;n++)n%2===0?t.node(e.assertion[n]):(t.put(" "),t.put(e.assertion[n]),t.put(" "));t.put(")")}else t.node(e.assertion)}const oe={in:"in","not in":"notIn",has:"has","has no":"hasNo",and:"and",or:"or","??":"nullish","+":"add","-":"sub","*":"mul","/":"div","%":"mod","=":"eq","!=":"ne","<":"lt","<=":"lte",">":"gt",">=":"gte","~=":"match"};function ue(e,t,n){if("Array"===n.type){if(0===n.elements.length)return void e.range([n.range[0]+1,n.range[1]-1],"value-subset",t,!1);const r=[];for(const{type:e,range:t,value:i}of n.elements)!t||"Literal"!==e&&"Identifier"!==e||r.push(i);const s=!!r.length&&e.literalList(r);for(const{type:i,range:a,value:o}of n.elements)a&&("Literal"===i||"Identifier"===i||"GetProperty"===i&&null===o)&&e.range(a,"value-subset",t,s)}}function le(e,t){switch(e.operator){case"in":t.range(e.left.range,"in-value",e.right,null),ue(t,e.left,e.right);break;case"not in":ue(t,e.left,e.right);break;case"has":t.range(e.right.range,"in-value",e.left,null),ue(t,e.right,e.left);break;case"has no":ue(t,e.right,e.left);break;case"=":case"!=":t.range(e.right.range,"value",e.left,null)}}function ce(e,t){if(e.operator in oe!==!1)switch(e.operator){case"and":t.put("!");case"or":{const n=t.allocateVar();t.put(`${t.buildinFn("bool")}(${n}=`),t.node(e.left),t.put(`)?${n}:`),t.scope.captureCurrent.disabled=!0,t.node(e.right),t.scope.captureCurrent.disabled=!1;break}case"??":{const n=t.allocateVar();t.put(`(${n}=`),t.node(e.left),t.put(`,${n}!==null&&${n}!==undefined)?${n}:`),t.scope.captureCurrent.disabled=!0,t.node(e.right),t.scope.captureCurrent.disabled=!1;break}case"has no":t.put("!");case"has":t.put(t.buildinFn("in")),t.put("("),t.node(e.right),t.put(","),t.node(e.left),t.put(")");break;default:t.put(t.buildinFn(oe[e.operator])),t.put("("),t.node(e.left),t.put(","),t.node(e.right),t.put(")")}else t.error('Unknown operator "'+e.operator+'"',e)}function pe(e,t){t.node(e.left),t.node(e.right)}function he(e,t){t.node(e.left),/^[a-z]/i.test(e.operator)?(t.put(" "),t.put(e.operator),t.put(" ")):t.put(e.operator),t.node(e.right)}function fe(e,t){null===e.body&&t.queryRoot(e.range[1])}function ge(e,t){e.definitions.length?t.createScope((()=>{for(const n of e.definitions)t.scope.awaitInit.add(n.declarator.name);t.put("(()=>{"),t.list(e.definitions),t.put("return "),t.nodeOrCurrent(e.body),t.put("})()")}),((e,t)=>e+t+";"),t.scope.$ref):e.body&&"Object"===e.body.type?(t.put("("),t.nodeOrCurrent(e.body),t.put(")")):t.nodeOrCurrent(e.body)}function ye(e,t){t.list(e.definitions),t.nodeOrNothing(e.body)}function de(e,t){t.list(e.definitions),t.nodeOrNothing(e.body)}const Ae={"":"cmp",N:"cmpNatural",A:"cmpAnalytical",NA:"cmpNaturalAnalytical",AN:"cmpNaturalAnalytical"};function me(e,t){e.order.startsWith("desc")&&t.put("-"),t.createScope((()=>{const n=Ae[e.order.slice(3+e.order.startsWith("desc"))]||Ae[""];t.put(t.buildinFn(n)),t.put("((_q=$=>("),t.node(e.query),t.put("))(a),_q(b))")}),((e,t)=>e+t+","))}function Ce(e,t){t.node(e.query)}function be(e,t){t.node(e.query),t.put(" "),t.put(e.order)}function Be(e,t){t.put("(a, b)=>{let _q;return "),t.list(e.compares,"||"),t.put("||0}")}function ve(e,t){t.list(e.compares)}function ke(e,t){t.list(e.compares,",")}function Ee(e,t){t.put(t.buildinFn("bool")),t.put("("),t.scope.captureCurrent.disabled=!0,t.nodeOrCurrent(e.test),t.put(")?"),t.nodeOrCurrent(e.consequent),t.put(":"),e.alternate?t.node(e.alternate):t.put("undefined"),t.scope.captureCurrent.disabled=!1}function $e(e,t){t.nodeOrNothing(e.test),t.nodeOrNothing(e.consequent),t.nodeOrNothing(e.alternate)}function we(e,t){t.nodeOrNothing(e.test),t.put("?"),t.nodeOrNothing(e.consequent),e.alternate&&(t.put(":"),t.node(e.alternate))}function Me(e,t){t.put("context")}function De(){}function _e(e,t){t.put("#")}function Oe(e,t){e.range&&t.range(e.range,"var")}function xe(e,t){t.put(t.scope.$ref)}function qe(){}function Ne(e,t){t.put("$")}function Se(e,t){t.put("data")}function Fe(){}function Ie(e,t){t.put("@")}function je(e,t){e.name&&t.put("$"+e.name)}function ze(){}function Te(e,t){t.put(e.name?"$"+e.name:"$")}function Pe(e,t){return{type:"GetProperty",value:e,property:t}}function Re(e){return{type:"Identifier",name:e}}const He=["data","context","ctx","array","idx","index"];function Le(e,t){null===e.value&&t.range(e.declarator.range,"path")}function Ge(e,t){if(null===e.declarator.name)return t.node(e.declarator),t.nodeOrCurrent(e.value),void t.put(";");t.scope.own.has(e.declarator.name)?t.error(`Identifier "$${e.declarator.name}" has already been declared`,e.declarator):He.includes(e.declarator.name)?t.error(`Identifier "$${e.declarator.name}" is reserved for future use`,e.declarator):(t.put("const "),t.node(e.declarator),t.put("="),t.node(e.value||Pe(null,Re(e.declarator.name))),t.put(";"),t.scope.add(e.declarator.name),t.scope.own.add(e.declarator.name),t.scope.awaitInit.delete(e.declarator.name))}function Ue(e,t){t.node(e.declarator),t.nodeOrNothing(e.value)}function Je(e,t){t.node(e.declarator),null!==e.value&&(t.put(":"),t.node(e.value)),t.put(";")}function We(e,t){t.put(t.buildinFn("filter")),t.put("("),t.nodeOrCurrent(e.value),t.createScope((()=>{t.put(",$=>"),t.node(e.query)}),((e,n)=>(t.put(")"),e+"("+n+","))),t.put(")")}function Ye(e,t){t.nodeOrNothing(e.value),t.node(e.query)}function Ke(e,t){t.nodeOrNothing(e.value),t.put(".["),t.node(e.query),t.put("]")}function Qe(e,t){t.createScope((()=>{const n=e.arguments.map((e=>"$"+e.name));t.scope.arg1=!0,t.scope.$ref=n[0]||"$";for(const r of e.arguments)t.scope.add(r.name);t.put("function("),t.put(String(n)||"$"),t.put("){return "),t.node(e.body),t.put("}")}),((e,t)=>e+t+","))}function Ze(e,t){t.node(e.body)}function Ve(e,t){t.put("=>"),t.node(e.body)}function Xe(e,t){t.range(e.property.range,"path",e.value||void 0,!e.value),null===e.value&&t.range(e.property.range,"var"),e.range&&null===e.value&&e.property.range[0]!==e.range[0]&&t.queryRoot(e.range[0])}function et(e,t){t.put(t.buildinFn("map")),t.put("("),t.nodeOrCurrent(e.value),t.put(","),"Identifier"===e.property.type?t.put(JSON.stringify(e.property.name)):t.node(e.property),t.put(")")}function tt(e,t){t.nodeOrNothing(e.value),t.node(e.property)}function nt(e,t){t.nodeOrNothing(e.value)&&t.put("."),t.node(e.property)}function rt(e,t){t.put(e.name)}function st(){}function it(e,t){t.put(e.name)}function at(e,t){t.put("string"===typeof e.value?JSON.stringify(e.value):String(e.value))}function ot(){}function ut(e,t){t.put("string"===typeof e.value?JSON.stringify(e.value):String(e.value))}function lt(e,t){t.put(t.buildinFn("map")),t.put("("),t.nodeOrCurrent(e.value),t.createScope((()=>{t.put(",$=>"),t.node(e.query)}),((e,n)=>(t.put(")"),e+"("+n+","))),t.put(")")}function ct(e,t){t.nodeOrNothing(e.value),t.node(e.query)}function pt(e,t){t.nodeOrNothing(e.value),t.put(".("),t.node(e.query),t.put(")")}function ht(e,t){t.put(t.buildinFn("mapRecursive")),t.put("("),t.nodeOrCurrent(e.value),t.createScope((()=>{t.put(",$=>"),t.node(e.query)}),((e,n)=>(t.put(")"),e+"("+n+","))),t.put(")")}function ft(e,t){t.nodeOrNothing(e.value),t.node(e.query)}function gt(e,t){t.nodeOrNothing(e.value),t.put(".."),t.isSimpleGetPropertyQuery(e.query)||t.isSimpleMethodCallQuery(e.query)?t.node(e.query):(t.put("("),t.node(e.query),t.put(")"))}function yt(e,t){0===e.arguments.length&&t.queryRoot(e.range[1]-1)}function dt(e,t,n){const r="Identifier"===e.reference.type;t.tolerant&&t.put("(typeof "),r&&(t.usedMethods.has(e.reference.name)?t.usedMethods.get(e.reference.name).push(e.reference.range):t.usedMethods.set(e.reference.name,[e.reference.range]),t.put("m.")),t.node(e.reference),t.tolerant&&(t.put('==="function"?'),r&&t.put("m."),t.node(e.reference)),t.put(r?".call(mctx,":"("),t.nodeOrCurrent(n),e.arguments.length&&(t.put(","),t.list(e.arguments,",")),t.put(")"),t.tolerant&&t.put(":undefined)")}function At(e,t){t.node(e.reference),t.list(e.arguments)}function mt(e,t){t.node(e.reference),t.put("("),t.list(e.arguments,","),t.put(")")}function Ct(e,t){t.node(e.method,e.value)}function bt(e,t){t.nodeOrNothing(e.value),t.node(e.method)}function Bt(e,t){t.nodeOrNothing(e.value)&&t.put("."),t.node(e.method)}function vt(e,t){0===e.properties.length&&t.queryRoot(e.range[0]+1,e.range[1]-1)}function kt(e,t){t.put("{"),t.list(e.properties,","),t.put("}")}function Et(e,t){t.list(e.properties)}function $t(e,t){t.put("{"),t.list(e.properties,","),t.put("}")}const wt=new Set(["Literal","Identifier","Reference","Current"]);function Mt(e,t){if(null===e.value)switch(e.key.type){case"Literal":case"Identifier":t.range(e.range,"path"),t.range(e.range,"var");break;case"Current":case"Reference":t.range(e.range,"var")}}function Dt(e,t){let n=e.value;switch(e.key.type){case"Current":return void t.put("...null");case"Literal":t.node(e.key),n=n||Pe(null,Re(String(e.key.value)));break;case"Identifier":t.node(e.key),n=n||Pe(null,Re(e.key.name));break;case"Reference":t.node(e.key.name),n=n||e.key;break;default:t.put("["),t.node(e.key),t.put("]")}t.put(":"),t.node(n)}function _t(e,t){t.node(e.key),t.nodeOrNothing(e.value)}function Ot(e,t){if(wt.has(e.key.type)){if(t.node(e.key),null===e.value)return}else t.put("["),t.node(e.key),t.put("]");t.put(":"),t.node(e.value)}function xt(e,t){t.put("("),t.node(e.body),t.put(")")}function qt(e,t){t.node(e.body)}function Nt(e,t){t.put("("),t.node(e.body),t.put(")")}function St(e,t){if(null===e.getter){const n=e.range[1]-1;t.range([n,n],"key",e.value,!1),t.queryRoot(n)}else("GetProperty"===e.getter.type||"Reference"===e.getter.type||"Literal"===e.getter.type&&"string"===typeof e.getter.value)&&t.range(e.getter.range,"key",e.value,!1)}function Ft(e,t){t.put(t.buildinFn("pick")),t.put("("),t.node(e.value),e.getter&&(t.put(","),t.node(e.getter)),t.put(")")}function It(e,t){t.node(e.value),null!==e.getter&&t.node(e.getter)}function jt(e,t){t.node(e.value),t.put("["),null!==e.getter&&t.node(e.getter),t.put("]")}function zt(e,t){t.createScope((()=>{t.put("($=>("),t.node(e.right),t.put("))")}),((e,t)=>e+t+",")),t.put("("),t.nodeOrCurrent(e.left),t.put(")")}function Tt(e,t){t.node(e.left),t.node(e.right)}function Pt(e,t){t.node(e.left),t.put("|"),t.node(e.right)}function Rt(e,t){t.queryRoot(e.range[1])}function Ht(e,t){t.put(t.scope.$ref)}function Lt(){}function Gt(){}function Ut(e,t){if(e.operator&&e.operator.type)return t.createScope((()=>{t.put("($=>("),t.node(e.operator),t.put("))")}),((e,t)=>e+t+",")),t.put("("),t.node(e.argument),void t.put(")");e.operator,t.error('Unknown operator "'+e.operator+'"',e)}function Jt(e,t){t.node(e.argument),e.operator&&e.operator.type&&t.node(e.operator)}function Wt(e,t){t.node(e.argument),t.put(" "),t.node(e.operator)}function Yt(e,t){switch(e.operator){case"no":case"not":t.put("!"),t.put(t.buildinFn("bool")),t.put("("),t.node(e.argument),t.put(")");break;case"+":case"-":t.put(e.operator),t.node(e.argument);break;case"is":t.put("!!("),t.node(e.argument),t.put(")");break;default:t.error('Unknown operator "'+e.operator+'"',e)}}function Kt(e,t){t.node(e.argument),e.operator&&e.operator.type&&t.node(e.operator)}function Qt(e,t){t.put(e.operator),"-"!==e.operator&&"+"!==e.operator&&t.put(" "),t.node(e.argument)}function Zt(e,t){e.range&&t.range(e.range,"var")}function Vt(e,t){const n=e.name,r=t.scope.has(n.name),s=t.scope.awaitInit.has(n.name);r&&!s?(t.put("$"),t.node(n)):s?(t.put("f.unsafeRef(()=>$"),t.node(n),t.tolerant||(t.put(","),t.put(JSON.stringify(n.name)),t.put(","),t.put(JSON.stringify(n.range))),t.put(")")):t.tolerant?t.put("undefined"):t.error(`$${n.name} is not defined`,n)}function Xt(e,t){t.node(e.name)}function en(e,t){t.put("$"),t.node(e.name)}function tn(e,t){t.put(t.buildinFn("slice")),t.put("("),t.nodeOrCurrent(e.value),e.arguments.slice(0,3).forEach((e=>{t.put(","),e?t.node(e):t.put("undefined")})),t.put(")")}function nn(e,t){t.nodeOrNothing(e.value);for(const n of e.arguments.slice(0,3))n&&t.node(n)}function rn(e,t){const[n,r,s]=e.arguments;t.nodeOrNothing(e.value),t.put("["),n&&t.node(n),t.put(":"),r&&t.node(r),s&&(t.put(":"),t.node(s)),t.put("]")}function sn(e,t){null===e.query&&t.queryRoot(e.range[1])}function an(e,t){if(e.array)return t.put("..."),t.put(t.buildinFn("ensureArray")),t.put("("),t.nodeOrCurrent(e.query),void t.put(")");t.put("..."),t.nodeOrCurrent(e.query)}function on(e,t){t.nodeOrNothing(e.query)}function un(e,t){t.put("..."),t.nodeOrNothing(e.query)}function ln(e,t){for(const[n,r]of Object.entries(e.values))null===r&&t.queryRoot(e.values[Number(n)-1].range[1])}function cn(e,t){for(const[n,r]of Object.entries(e.values)){const e=Number(n);null!==r&&(0!==e&&t.put("+"),e%2===0?t.put('"'+yn(r.value,fn)+'"'):(t.put("("),t.node(r),t.put(")")))}}function pn(e,t){for(const n of e.values)null!==n&&t.node(n)}function hn(e,t){const n=e.values.length-1;for(const[r,s]of Object.entries(e.values)){const e=Number(r);e%2===0?(t.put(0===e?"`":"}"),t.put(yn(s.value,gn)),t.put(e===n?"`":"${")):null!==s&&t.node(s)}}const fn=new Map([["\b","\\b"],["\n","\\n"],["\r","\\r"],["\f","\\f"],["\t","\\t"],["\v","\\v"],["\u2028","\\u2028"],["\u2029","\\u2029"],["\\","\\\\"],['"','\\"']]),gn=new Map([["\b","\\b"],["\f","\\f"],["\t","\\t"],["\v","\\v"],["\\","\\\\"],["$","\\$"]]);function yn(e,t){let n="";for(let r=0;r<e.length;r++)n+=t.get(e[r])||e[r];return n}const dn={Arg1:n,Array:r,Assertion:s,Binary:i,Block:a,Compare:o,Conditional:l,Context:c,Current:p,Data:h,Declarator:f,Definition:g,Filter:y,Function:d,GetProperty:A,Identifier:m,Literal:C,Map:b,MapRecursive:B,Method:v,MethodCall:k,Object:E,ObjectEntry:$,Parentheses:w,Pick:M,Pipeline:D,Placeholder:_,Postfix:O,Prefix:x,Reference:q,SliceNotation:N,CompareFunction:u,Spread:S,Template:F},An=e=>new Map(Object.entries(dn).map((t=>{let[n,r]=t;return[n,r[e]]})).filter((e=>{let[,t]=e;return"function"===typeof t}))),mn={};An("build").forEach(((e,t)=>mn[t]=e));const Cn=An("compile"),bn=An("walk"),Bn=An("stringify"),vn=An("suggest");function kn(e,t){function n(e){if(!bn.has(e.type))throw new Error('Unknown node type "'+e.type+'"');s(e),bn.get(e.type)(e,r),i(e)}const r={node:n,nodeOrNothing(e){null!==e&&n(e)},list(e){e.forEach(n)}};let s=()=>{},i=()=>{};"function"===typeof t&&(t={enter:t}),t&&("function"===typeof t.enter&&(s=t.enter),"function"===typeof t.leave&&(i=t.leave)),n(e)}function En(e,t){return t>=0&&t<e.length&&/[a-zA-Z_$0-9]/.test(e[t])}function $n(e,t){const n=e.charCodeAt(t);return 9===n||10===n||13===n||32===n}function wn(e,t,n){for(;t<n;t++)if(!$n(e,t))return!1;return!0}function Mn(e,t,n,r,s){const i=[];for(let a=0;a<r.length;a++){const[n,s]=r[a];if(n>=t)break;n<e||(i.push(e,n),e=s)}return e===n.length&&s||i.push(e,t),i}function Dn(e,t,n,r){const s=[];for(let i=0;i<e.length;i++){let[a,o,u,l]=e[i];if(wn(t,a,o)){for(;a>=0&&$n(t,a-1);)a--;for(;o<t.length&&$n(t,o);)o++;if(En(t,a-1)){if(a===o)continue;a++}if(En(t,o)){if(a===o)continue;o--}}const c=Mn(a,o,t,n,r);for(let e=0;e<c.length;e+=2)s.push([c[e],c[e+1],u,l])}return s}function _n(e,t){let{ast:n,commentRanges:r}=t;const s=function(e){let t=null;const n=[],r=Object.assign(new Map,{literalList:n}),s=(e,t)=>{r.has(e)?r.get(e).push(t):r.set(e,[t])},i={range(e,n){s(arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,[...e,n,!(arguments.length>3&&void 0!==arguments[3])||arguments[3]])},literalList(e){const t="l"+n.length;return n.push([t,e]),t},queryRoot(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;s(t,[e,n,"var",!0]),s(t,[e,n,"path",!0])}};return kn(e,(e=>{if(vn.has(e.type)){const n=t;t=e,vn.get(e.type)(e,i),t=n}})),r}(n),i=r.length&&r[r.length-1][1]===e.length&&!/[\r\n]$/.test(e);for(const[a,o]of s)s.set(a,Dn(o,e,r,i));return s}function On(e){return"GetProperty"===e.type}function xn(e){return"MethodCall"===e.type}function qn(e){function t(e){if(!Bn.has(e.type))throw new Error('Unknown node type "'+e.type+'"');Bn.get(e.type)(e,r)}const n=[],r={isSimpleGetPropertyQuery:On,isSimpleMethodCallQuery:xn,put(e){n.push(e)},node:t,nodeOrNothing(e){if(null!==e)return t(e),!0},list(e,n){n?e.forEach(((e,s)=>{s>0&&r.put(n),t(e)})):e.forEach(t)}};return t(e),n.join("")}function Nn(e,t,n){return In(e,"query",t,n)}function Sn(e,t,n){return In(e,"method",t,n)}class Fn extends Set{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"$";super(e),this.own=new Set,this.awaitInit=new Set(t),this.firstCurrent=null,this.captureCurrent=[],this.arg1=n,this.$ref=r}spawn(e,t){return new Fn(this,this.awaitInit,e,t)}}function In(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;function s(e){const t="s"+l.length;return l.push(e?[t,e]:[t]),t}function i(e){let t=c.get(e);return t||c.set(e,t=s()),t}function a(e,t,n,r,a){let o=[e,t,JSON.stringify(n)];if("var"===n){if(!d.scope.size)return;o.push(JSON.stringify([...d.scope]))}else r||(r=s()),o.push(r),a&&o.push("string"===typeof a?a:i(a));return h.push(o),r}function o(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"$";const s=d.scope,i=f.length;if(d.scope=s.spawn(s.arg1||"method"===t,r),e(),d.scope.captureCurrent.length){const e="stat("+d.scope.captureCurrent.reduce(((e,t)=>a(...t,e)),void 0)+","+d.scope.$ref+")";d.scope.firstCurrent?f[d.scope.firstCurrent]=e:f[i]=n(f[i],e)}d.scope=s}function u(e,t){let n=!1;if(null!==r){if(r.has(e))for(const[t,s,o,u]of r.get(e))"var"===o?a(t,s,o):!0===u?d.scope.captureCurrent.push([t,s,o]):(n||(n=i(e),f.push("stat("+n+",")),o&&a(t,s,o,n,u));"Current"===e.type&&null===d.scope.firstCurrent&&!0!==d.scope.captureCurrent.disabled&&(d.scope.firstCurrent=f.length)}if(!Cn.has(e.type))throw new Error('Unknown node type "'+e.type+'"');Cn.get(e.type)(e,d,t),n&&f.push(")")}const l=[],c=new WeakMap,p=[],h=[],f=[{toString(){if("query"===t)return["((data,context)=>{",...d.usedMethods.size||d.usedAssertions.size?["const method = (name,...args)=>m[name].apply(mctx,args);","const assertion = (name,...args)=>a[name].apply(mctx,args);","const mctx = Object.freeze({context,method,assertion});"]:[]].join("\n")+"\n";if("method"===t)return["(function(data){","const mctx = this;","const context = mctx.context;"].join("\n")+"\n";throw new Error("Unknown kind: "+t)}},{toString:()=>p.length>0?"let "+p+";\n":""},{toString:()=>l.length>0?["const stat=(s,v)=>(s.add(v),v);\n","const "+l.map((e=>{let[t,n]=e;return t+"=new Set("+(n?JSON.stringify(n):"")+")"}))+";\n"].join(""):""},{toString(){const e=r&&Array.isArray(r.literalList)&&r.literalList.map((e=>{let[t,n]=e;return t+"="+JSON.stringify(n)}));return e&&e.length?"const "+e+";\n":""}},null===r?"return ":"return{\nvalue: "],g={},y=new Set,d={tolerant:n,usedAssertions:new Map,usedMethods:new Map,suggestions:null!==r,buildinFn:e=>(y.add(e),"f."+e),scope:new Fn,createScope:o,error:(e,t)=>{const r=new SyntaxError(e);if(t&&t.range&&(r.details={loc:{range:t.range}}),!n)throw r},allocateVar(){const e="tmp"+p.length;return p.push(e),e},put:e=>f.push(e),node:u,nodeOrCurrent(e,t){u(e||{type:"Current"},t)},list(e,t,n){e.forEach(((e,r)=>{r>0&&f.push(t),u(e,n)}))}};if(o((()=>u(e)),((e,t)=>(f.push(")"),"("+t+","+e)),"data"),!n){const{usedMethods:e,usedAssertions:t}=d;t.size&&(f.unshift(" this.assertAssertions(a)||"),g.assertAssertions=function(e){for(const[n,r]of t.entries())if(!I(e,n))return()=>{throw Object.assign(new Error(`Assertion "${n}" is not defined`),{details:{loc:{range:r}}})}}),e.size&&(f.unshift(" this.assertMethods(m)||"),g.assertMethods=function(t){for(const[n,r]of e.entries())if(!I(t,n))return()=>{throw Object.assign(new Error(`Method "${n}" is not defined. If that's a custom method make sure you added it with "methods" section in options`),{details:{loc:{range:r[0]}}})}})}null!==r&&f.push(",\nstats: ["+h.map((e=>"["+e+"]"))+"],\nmethods: m,\nassertions: a\n}");try{const e=new Function("f,m,a","return"+f.join("")+"})");return Object.assign(e.bind(g),{toString:()=>e.toString().replace(/^(\S+\s+)anonymous([^)\s]+)\s*\)/,"$1query$2)")})}catch(A){throw function(e,t,n){const r=Object.assign(Object.create(SyntaxError.prototype),n),s=new Error;return r.name=e,r.message=t,Object.defineProperty(r,"stack",{get:function(){return(s.stack||"").replace(/^(.+\n){1,3}/,e+": "+t+"\n")}}),r}("SyntaxError","Jora query compilation error",{compiledSource:f.join(""),details:A})}}const jn=e=>"number"===typeof e||"string"===typeof e,zn=(e,t)=>t<e.length?e.charCodeAt(t):0,Tn=e=>43===e||45===e,Pn=e=>e>=48&&e<=57,Rn=e=>9===e||10===e||12===e||13===e||32===e,Hn=e=>e>32&&e<256&&(e<65||e>90)&&(e<97||e>122)&&!Pn(e)&&!Tn(e)||8470===e,Ln=e=>e&&!Rn(e)&&!Hn(e)&&!Pn(e),Gn=(e,t,n)=>{for(;n(zn(e,++t)););return t},Un=(e,t,n,r)=>{if(t>=e.length)return 0;const s=zn(e,t);return Rn(s)?1|Gn(e,t,Rn)-t<<4:Hn(s)||r&&Tn(s)?2|Gn(e,t,Hn)-t<<4:(i=s,a=zn(e,t+1),o=zn(e,t+2),(Tn(i)?Pn(a)||46===a&&Pn(o):Pn(i))?4|((e,t,n)=>{let r=zn(e,t);if(Tn(r)&&(r=zn(e,t+=1)),Pn(r)&&(t=Gn(e,t,Pn),r=zn(e,t)),46===r&&Pn(zn(e,t+1))){if(n)return t;const s=Gn(e,t+1,Pn);if(r=zn(e,s),46===r)return t;t=s}if(69===r||101===r){let n=1;r=zn(e,t+1),Tn(r)&&(n=2,r=zn(e,t+2)),Pn(r)&&(t=Gn(e,t+n,Pn))}return t})(e,t,n)-t<<4:8|Gn(e,t,Ln)-t<<4);var i,a,o},Jn=e=>(t,n)=>{if(jn(t)&&jn(n)){const r=Math.sign(((e,t,n)=>{let r=0,s=0,i=!1,a=!1,o=0,u=0,l=!0;for(;;){const c=Un(e,r,i,a),p=Un(t,s,i,a),h=15&c,f=c>>4,g=15&p,y=p>>4;if(h!==g){if(l&&3&h&&12&g){o=1,u=h,r+=f;continue}if(l&&3&g&&12&h){o=-1,u=g,s+=y;continue}return h-g}if(0===h)return o;l=!1,i=!1,a=!1;const d=f<y?f:y;let A=f-y,m="",C="";for(let n=0;n<d;n++)if(m=e[r+n],C=t[s+n],m!==C){A=m<C?-1:1;break}if(3&h)i="."===e[r+f-1],0!==A&&h>u&&(u=h,o=A);else if(4&h){if(a=!0,0!==A){const i=e.substr(r,f)-t.substr(s,y);if(0!==i)return n?-i:i;if(h>u){const i=zn(e,r),a=zn(t,s),l=45===i?-1:1;u=h,o=i===a||45!==i&&43!==a?i===a||43!==i&&45!==a?(f-y||A)<0?-l:l:1:-1,n&&(o=-o)}}}else if(0!==A){if(m!==C){const n=e.substr(r,f),i=t.substr(s,y),a=n.toLowerCase(),o=i.toLowerCase();return a!==o?a<o?-1:1:n<i?-1:1}return A}r+=f,s+=y}})(String(t),String(n),e));return r}return 0},Wn=Jn(!1),Yn=Jn(!0),Kn=1,Qn=2,Zn=3,Vn=4,Xn=5,er=6,tr=7,nr=8;function rr(e){switch(typeof e){case"boolean":return Kn;case"number":return e!==e?Qn:Zn;case"string":return Vn;case"object":return null===e?Xn:er;case"undefined":return nr;default:return tr}}function sr(e,t){const n=rr(e),r=rr(t);return n!==r?n<r?-1:1:e<t?-1:e>t?1:0}function ir(e,t){const n=rr(e),r=rr(t);return n!==Zn&&n!==Vn||r!==Zn&&r!==Vn?n!==r?n<r?-1:1:e<t?-1:e>t?1:0:Wn(e,t)}function ar(e,t){return 1===e.length?(n,r)=>t(e(n),e(r)):e}const or=Object.freeze({unsafeRef:function(e,t,n){try{return e()}catch(r){if(t)throw Object.assign(new ReferenceError(`Cannot access $${t} before initialization`),{details:{name:t,loc:{range:n}}})}},ensureArray:function(e){return L(e)?e:[e]},bool:U,and:(e,t)=>U(e)?t:e,or:(e,t)=>U(e)?e:t,add:function(e,t){if(L(e)||L(t))return[...new Set([...L(e)?e:[e],...L(t)?t:[t]])];return e+t},sub:function(e,t){if(L(e)){const n=new Set(e);return L(t)?t.forEach((e=>n.delete(e))):n.delete(t),[...n]}return e-t},mul:function(e,t){return e*t},div:function(e,t){return e/t},mod:function(e,t){return e%t},eq:function(e,t){return Object.is(e,t)},ne:function(e,t){return!Object.is(e,t)},lt:function(e,t){return e<t},lte:function(e,t){return e<=t},gt:function(e,t){return e>t},gte:function(e,t){return e>=t},in:ur,notIn:(e,t)=>!ur(e,t),has:(e,t)=>ur(t,e),hasNo:(e,t)=>!ur(t,e),cmp:sr,cmpAnalytical:function(e,t){const n=rr(e),r=rr(t);return n!==r?n<r?-1:1:n===Zn?t-e:e<t?-1:e>t?1:0},cmpNatural:ir,cmpNaturalAnalytical:function(e,t){const n=rr(e),r=rr(t);return n!==Zn&&n!==Vn||r!==Zn&&r!==Vn?n!==r?n<r?-1:1:e<t?-1:e>t?1:0:Yn(e,t,!0)},match:function(e,t){if("function"===typeof t)return pr(e,t);if(R(t))return pr(e,t.test.bind(t));if(null===t||void 0===t)return!0;return!1},pick:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>!0;if(!e)return;if("function"===typeof t){if(L(e)||"string"===typeof e)for(let n=0;n<e.length;n++)if(U(t(e[n],n)))return e[n];for(const n in e)if(I(e,n)&&U(t(e[n],n)))return e[n];return}if(L(e)||"string"===typeof e)return isFinite(t)?e[t<0?e.length+Number(t):Number(t)||0]:void 0;return I(e,t)?e[t]:void 0},indexOf:function(e,t,n){return e?lr(e,t,n):-1},lastIndexOf:function(e,t,n){return e?function(e,t,n){if(Number.isNaN(t)&&H(e))for(let r=G(n,e.length-1);r>=0;r--)if(Number.isNaN(e[r]))return r;if("function"===typeof e.lastIndexOf)return e.lastIndexOf(t,G(n,e.length-1));return-1}(e,t,n):-1},map:cr,mapRecursive:function(e,t){const n=new Set;return z(n,cr(e,t)),n.forEach((e=>z(n,cr(e,t)))),[...n]},some:pr,filter:function(e,t){if(L(e))return e.filter((e=>U(t(e))));return U(t(e))?e:void 0},slice:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!H(e))return[];if(t=G(t,0),n=G(n,e.length),r=G(r,1)||1,t=t<0?Math.max(0,e.length+t):Math.min(e.length,t),n=n<0?Math.max(0,e.length+n):Math.min(e.length,n),t>=0&&n>=0&&t<=n&&1===r)return"string"===typeof e?e.slice(t,n):Array.prototype.slice.call(e,t,n);t>n&&([t,n]=[n,t],r=-r);const s=[];if(r>0)for(let i=t;i<n;i+=r)s.push(e[i]);else for(let i=n-1;i>=t;i+=r)s.push(e[i]);return"string"===typeof e?s.join(""):s}});function ur(e,t){return P(t)?I(t,e):!!t&&-1!==lr(t,e)}function lr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(Number.isNaN(t)&&H(e))for(let r=G(n,0);r<e.length;r++)if(Number.isNaN(e[r]))return r;return"function"===typeof e.indexOf?e.indexOf(t,n):-1}function cr(e,t){const n="function"===typeof t?t:e=>function(e,t){return e&&I(e,t)?e[t]:void 0}(e,t);return L(e)?[...e.reduce(((e,t)=>z(e,n(t))),new Set)]:void 0!==e?n(e):e}function pr(e,t){return L(e)?e.some((e=>U(t(e)))):U(t(e))}const hr=fr(20)?1/0:fr(10)?10:0;function fr(e){return Array.from({length:e},((e,t)=>({idx:t}))).sort(((e,t)=>e.idx%2-t.idx%2)).every(((t,n)=>n<e/2?t.idx>>1===n:Math.ceil(e/2)+(t.idx>>1)===n))}const gr=(e,t)=>e-t,yr=(e,t)=>t-e;class dr{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.maxSize=e||1/0,this.compare=t||yr,this.accept=n||null,this.values=[],this.valuesSet=r?new Set:null}add(e){(null===this.accept||this.accept(e))&&(null!==this.valuesSet&&this.valuesSet.has(e)||(this.values.length<this.maxSize?(null!==this.valuesSet&&this.valuesSet.add(e),this.values.push(e),this.heapifyUp(this.values.length-1)):this.compare(this.values[0],e)>0&&(null!==this.valuesSet&&(this.valuesSet.delete(this.values[0]),this.valuesSet.add(e)),this.values[0]=e,this.heapifyDown())))}addArray(e){for(let t=0;t<e.length;t++)this.add(e[t])}extract(){const e=this.values[0],t=this.values.pop();return this.values.length>0&&(this.values[0]=t,this.heapifyDown()),null!==this.valuesSet&&this.valuesSet.delete(e),e}heapifyUp(e){const t=this.values;let n=t[e];for(;e>0;){const r=e-1>>1,s=t[r];if(this.compare(s,n)>0)break;t[r]=n,t[e]=s,e=r}}heapifyDown(){const e=this.values,t=e.length,n=t>>1;let r=0,s=e[r],i=r,a=s;for(;r<n;){const n=2*r+1,o=e[n],u=n+1;if(this.compare(o,s)>0&&(i=n,a=o),u<t){const t=e[u];this.compare(t,a)>0&&(i=u,a=t)}if(i===r)break;e[r]=a,e[i]=s,r=i,a=s}}[Symbol.iterator](){return this.values.slice().sort(this.compare)[Symbol.iterator]()}}class Ar extends dr{}class mr extends dr{constructor(e,t,n,r){super(e,t?(e,n)=>-t(e,n):gr,n,r)}}const Cr=e=>e;function br(e){return null!==e&&"object"===typeof e?NaN:Number(e)}function Br(e,t,n){if(H(e)){"function"!==typeof t&&(t=Cr);for(const r of e){const e=t(r);void 0!==e&&n(br(e))}}}function vr(e,t,n,r,s){if(0===e.length||!isFinite(t)||t<0||t>100)return;let i=0,a=t*(e.length-1)/100,o=Math.floor(a),u=Math.ceil(a),l=!1;const c=t<50?new mr(u+1,s):new Ar(e.length-o,s);if(Br(e,n,(e=>{Number.isNaN(e)&&(l=!0),c.add(e),i++})),l)return NaN;if(e.length!==i){if(0===i)return;a=t*(i-1)/100,o=Math.floor(a),u=Math.ceil(a);const e=t<50?u+1:i-o;for(let t=c.values.length;t>e;t--)c.extract()}if(o!==u){const e=c.extract(),t=c.values[0];return e<=t?e+(t-e)*(a-o):t+(e-t)*(a-o)}return c.values[0]}const kr=e=>e;function Er(e,t){let n,r=0,s=0;return Br(e,t,(e=>{if(s++,void 0===n)n=e;else{const t=n,s=Math.abs(t),i=Math.abs(e);n+=e,s!==1/0&&i!==1/0&&(r+=s>=i?t-n+e:e-n+t)}})),void 0!==n&&(n+=r),{sum:n,count:s}}function $r(e,t){let n=0,r=0,s=0;if(Br(e,t,(e=>{n+=1;let t=e-r;r+=t/n,s+=t*(e-r)})),n>0)return s/n}function wr(e,t,n){if(H(e))return vr(e,t,n)}function Mr(){}function Dr(e){return e}function _r(e){return null===e?null:{matched:e.slice(),start:e.index,end:e.index+e[0].length,input:e.input,groups:e.groups||null}}const Or=String.prototype.replaceAll||function(e,t){return R(e)?this.replace(e,t):this.split(e).join(String(t))},xr=Object.freeze({bool:or.bool,filter:or.filter,map:or.map,pick:or.pick,indexOf:or.indexOf,lastIndexOf:or.lastIndexOf,keys:e=>Object.keys(e||{}),values(e){const t=new Set;for(const n in e)I(e,n)&&z(t,e[n]);return[...t]},entries(e){const t=[];for(const n in e)I(e,n)&&t.push({key:n,value:e[n]});return t},fromEntries(e){const t=Object.create(null);if(Array.isArray(e))for(const n of e)n&&(t[n.key]=n.value);return t},size:e=>P(e)?Object.keys(e).length:e&&e.length||0,sort(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sr;if(!L(e))return e;if("function"===typeof t&&2!==t.length){const e=t;t=(t,n)=>{if(t=e(t),n=e(n),Array.isArray(t)&&Array.isArray(n)){if(t.length!==n.length)return t.length<n.length?-1:1;for(let e=0;e<t.length;e++){const r=sr(t[e],n[e]);if(0!==r)return r}return 0}return sr(t,n)}}return function(e,t){return e.length<=hr?e.slice().sort(t):e.map(((e,t)=>({value:e,idx:t}))).sort(((e,n)=>(void 0===e.value?void 0!==n.value:void 0===n.value?-1:t(e.value,n.value))||e.idx-n.idx)).map((e=>e.value))}(e,t)},reverse:e=>L(e)?e.slice().reverse():e,slice:(e,t,n)=>"string"===typeof e||L(e)?e.slice(t,n):Array.prototype.slice.call(e,t,n),group(e,t,n){const r=new Map,s=[];"function"!==typeof t&&(t=Mr),"function"!==typeof n&&(n=Dr),L(e)||(e=[e]);for(const i of e){const e=t(i);if(L(e))if(e.length>0){const t=n(i);for(const n of e)T(r,n,t)}else T(r,void 0,n(i));else T(r,e,n(i))}for(const[i,a]of r)s.push({key:i,value:[...a]});return s},join:(e,t)=>L(e)?e.join(t):String(e),match(e,t,n){const r=String(e),s=R(t)?t.flags:"";if(n||s.includes("g")){const e=[];let n,i=new RegExp(t,(s||"").replace(/g|$/,"g"));for(;n=i.exec(r);)e.push(_r(n));return e}return _r(r.match(t))},reduce(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return L(e)?void 0!==n?e.reduce(((e,n)=>t(n,e)),n):e.reduce(((e,n)=>t(n,e))):t(e,n)},split(e,t){if(L(e)){const n="function"===typeof t?t:Object.is.bind(null,t),r=[];let s=0,i=0;for(;i<e.length;i++)n(e[i])&&(r.push(e.slice(s,i)),s=i+1);return r.push(e.slice(s,i)),r}return String(e).split(t)},replace(e,t,n){if(L(e)){const r="function"===typeof t?t:Object.is.bind(null,t),s=[...e];for(let e=0;e<s.length;e++){const t=s[e];r(t)&&(s[e]="function"===typeof n?n(t):n)}return s}return R(t)&&!t.flags.includes("g")&&(t=new RegExp(t,t.flags+"g")),Or.call(String(e),t,"function"===typeof n?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n(function(e){const t=e.pop(),n="string"===typeof t?null:t,r=null===n?t:e.pop(),s=e.pop();return{matched:e,start:s,end:s+e[0].length,input:r,groups:n}}(t))}:n)},toLowerCase:(e,t)=>String(e).toLocaleLowerCase(t),toUpperCase:(e,t)=>String(e).toLocaleUpperCase(t),trim:e=>String(e).trim(),...["abs","acos","acosh","asin","asinh","atan","atan2","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","hypot","imul","log10","log2","pow","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].reduce(((e,t)=>(e[t]=Math[t],e)),{}),ln:Math.log,ln1p:Math.log1p,numbers:function(e,t){const n=[];return Br(e,t,n.push.bind(n)),n},count:function(e,t){let n=0;if(H(e)){"function"!==typeof t&&(t=kr);for(const r of e)void 0!==t(r)&&n++}return n},sum:function(e,t){return Er(e,t).sum},avg:function(e,t){const{sum:n,count:r}=Er(e,t);if(r>0)return n/r},variance:$r,stdev:function(e,t){const n=$r(e,t);if(void 0!==n)return Math.sqrt(n)},min:function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ir;if(e&&isFinite(e.length)&&"function"===typeof n){n=ar(n,ir);for(let r=0;r<e.length;r++){const s=e[r];(void 0===t||n(s,t)<0)&&0!==n(s,void 0)&&(t=s)}}return t},max:function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ir;if(e&&isFinite(e.length)&&"function"===typeof n){n=ar(n,ir);for(let r=0;r<e.length;r++){const s=e[r];(void 0===t||n(s,t)>=0)&&0!==n(s,void 0)&&(t=s)}}return t},percentile:wr,p:wr,median:function(e,t){return wr(e,50,t)}}),qr=Object.freeze({function:e=>"function"===typeof e,symbol:e=>"symbol"===typeof e,primitive:e=>null===e||"object"!==typeof e&&"function"!==typeof e,string:e=>"string"===typeof e,number:e=>"number"===typeof e,int:Number.isInteger,finite:e=>Number.isFinite(e),nan:e=>Number.isNaN(e),infinity:e=>e===1/0||e===-1/0,boolean:e=>!0===e||!1===e,null:e=>null===e,undefined:e=>void 0===e,nullish:e=>null===e||void 0===e,object:P,array:L,regexp:R,truthy:U,falsy:e=>!U(e)}),Nr={path:"property",key:"value",value:"value","in-value":"value","value-subset":"value",var:"variable",assertion:"assertion"};function Sr(e,t){Object.keys(e).forEach(t.add,t)}function Fr(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;const s=e=>{switch(typeof e){case"string":case"number":r.add(e)}};switch(e){case"path":{const e=new Set;for(const n of t)if(Array.isArray(n))for(const t of n)P(t)&&Sr(t,e);else P(n)&&Sr(n,e);e.forEach(r.add,r);break}case"key":{const e=new Set;for(const n of t)null===n||"object"!==typeof n||Array.isArray(n)||Sr(n,e);e.forEach(r.add,r);break}case"value":for(const e of t)s(e);break;case"in-value":{const e=new Set;for(const n of t)L(n)?n.forEach(s):P(n)&&Sr(n,e);e.forEach(r.add,r);break}case"var":for(const e of t)r.add("$"+e);break;case"value-subset":{const e=new Set(n);for(const n of t)e.has(n)||s(n);break}}return r}function Ir(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=[];for(let[i,a,o,u,l=null]of n)if(t>=i&&t<=a&&(r||u.size||u.length)){let n=e.substring(i,a);/\S/.test(n)||(i=a=t,n=""),s.push({context:o,from:i,to:a,text:n,values:u,related:l})}return s}function jr(e,t){return"function"===typeof e?e:!0===e&&t}function zr(e){if(/^(["']).*\1$/.test(e))try{return"'"===e[0]&&(e=`"${e.slice(1,-1).replace(/\\.|"/g,(e=>"\\'"===e?"'":'"'===e?'\\"':e))}"`),JSON.parse(e)}catch(t){}return e}function Tr(e){return t=>-1!==("string"===typeof t?t:String(t)).toLowerCase().indexOf(e)}const Pr=(e,t)=>{let{value:n,stats:r,assertions:s}=t;return{get value(){return n},stat:(t,n)=>Ir(e,t,r,n),suggestion(t,n){let{limit:i=1/0,sort:a,filter:o}=n||{};a=jr(a,or.cmp),o=jr(o,Tr);const u=a&&isFinite(i)?Ar:Set,l=Ir(e,t,r,!0),c=new Map,p=[];for(const e of l){const{context:t,text:n,from:r,to:l,values:p,related:h}=e,f=Nr[t];if(!c.has(f)){let e;switch(u){case Ar:e=new Ar(i,a,o&&o(zr(n)),!0);break;case Set:e=new Set}c.set(f,{type:f,from:r,to:l,text:n,suggestions:e})}const{suggestions:g}=c.get(f);if("assertion"===t){if(0===g.size||g.values&&0===g.values.length)for(const e of Object.keys(s))g.add(e)}else Fr(t,p,h,g)}if(u===Set)for(const e of c.values()){let{suggestions:t}=e;if(a&&(t=[...t].sort(a)),o||isFinite(i)){const n=[],r=o?o(zr(e.text)):()=>!0;for(const e of t)if(r(e)&&n.push(e)>=i)break;t=n}e.suggestions=t}for(const e of c.values())e.suggestions=Array.isArray(e.suggestions)?e.suggestions:[...e.suggestions],e.suggestions.length&&p.push(e);return p.length?p:null}}},Rr=new Map,Hr=new Map,Lr=new Map,Gr=new Map;function Ur(e,t,n,r,s){"string"===typeof n?Object.defineProperty(e,t,{configurable:!0,get(){const i=Yr(n,"method")(or,r,s);return Object.defineProperty(e,t,{enumerable:!0,value:i}),i}}):"function"===typeof n&&Object.defineProperty(e,t,{enumerable:!0,value:n})}function Jr(e,t){if(!e&&!t)return{queryMethods:xr,queryAssertions:qr};const n={...xr},r={...qr};for(const[s,i]of Object.entries(e||{})){if(I(xr,s))throw new Error(`Builtin method "${s}" can't be overridden`);Ur(n,s,i,n,r)}for(const[s,i]of Object.entries(t||{})){if(I(qr,s))throw new Error(`Builtin assertion "${s}" can't be overridden`);Ur(r,s,i,n,r)}return{queryMethods:n,queryAssertions:r}}function Wr(e,t){console.log(`[${e}]`),"string"===typeof t?console.log(t):void 0!==t&&console.dir(t,{depth:null}),console.log()}function Yr(e,t,n,r,s){(s="function"===typeof s?s:!!Boolean(s)&&Wr)&&(s("========================="),s("Compile query from source",e));const i=K.parse(e,r);s&&(s("AST",i.ast),s("Restored source",qn(i.ast)));const a=n?_n(e,i):null;if(s&&a){const t=e=>JSON.stringify(e).slice(1,-1),n=[].concat(...[...a.entries()].map((e=>{let[t,n]=e;return n.map((e=>[t,...e]))})));let r=[],i=null;s("Stat/suggestion ranges",n.sort(((e,t)=>e[1]-t[1])).map((n=>{let[s,...a]=n;const[o,u,l,c]=a;let p;if(o===r[0]&&u===r[1])p=" ".repeat(i.length);else{const n=t(e.slice(0,o)).length,s=t(e.substring(o,u)).length;r=a,i=" ".repeat(n)+(s?"~".repeat(s):"\\")+" "+o+":"+u,p=t(e)+"\n"+i}return p+" ["+l+"] on "+s.type+(!0===c?" (current)":c&&c.type?" & "+c.type:"")})).join("\n"))}const o="method"===t?Sn(i.ast,r,a):Nn(i.ast,r,a);return s&&s("Compiled code",o.toString()),o}const Kr=Object.assign((function(e,t){t=t||{};const n=Boolean(t.stat),r=Boolean(t.tolerant),s=n?r?Gr:Hr:r?Lr:Rr,{methods:i,assertions:a}=t||{},{queryMethods:o,queryAssertions:u}=Jr(i,a);let l;return e=String(e),s.has(e)&&!t.debug?l=s.get(e):(l=Yr(e,"query",n,r,t.debug),s.set(e,l)),l=l(or,o,u),n?Object.assign(((t,n)=>Pr(e,l(t,n))),{query:l}):l}),{version:"1.0.0-beta.12",buildin:or,methods:xr,assertions:qr,setup:function(e){const t=new Map,n=new Map,r=new Map,s=new Map,{methods:i,assertions:a}=e||{},{queryMethods:o,queryAssertions:u}=Jr(i,a);return function(e,i){i=i||{};const a=Boolean(i.stat),l=Boolean(i.tolerant),c=a?l?s:n:l?r:t;let p;if(e=String(e),c.has(e)&&!i.debug)p=c.get(e);else{const t=Yr(e,"query",a,l,i.debug)(or,o,u);p=a?Object.assign(((n,r)=>Pr(e,t(n,r))),{query:t}):t,c.set(e,p)}return p}},syntax:{tokenize:K.tokenize,parse:K.parse,suggest:_n,walk:kn,stringify:qn,compile:Nn,compileMethod:Sn}});function Qr(e){const{query:t,input:n}=e;console.log("Worker received:",{query:t,input:n});try{const e=Kr(t),r=e(JSON.parse(n));console.log("Worker result:",r),self.postMessage(JSON.stringify({result:r}))}catch(r){console.error("Worker error:",r),self.postMessage(JSON.stringify({error:r.message}))}}console.log("Worker is initializing"),self.onmessage=e=>{console.log("Worker received:",e);const t=JSON.parse(e.data||"{}");"executeQuery"===t.name&&Qr(t)},addEventListener("message",(function(e){var n,r=e.data,s=r.type,i=r.method,a=r.id,o=r.params;"RPC"===s&&i&&((n=t[i])?Promise.resolve().then((function(){return n.apply(t,o)})):Promise.reject("No such method")).then((function(e){postMessage({type:"RPC",id:a,result:e})})).catch((function(e){var t={message:e};e.stack&&(t.message=e.message,t.stack=e.stack,t.name=e.name),postMessage({type:"RPC",id:a,error:t})}))})),postMessage({type:"RPC",method:"ready"})})();
//# sourceMappingURL=4217eb3b6c3439827ce0.worker.js.map